import{r as t,a as ks,R as Cs}from"./vendor-a6b94228.js";import{L as he,X as ye,S as Me,V as De,Z as Ve,K as Fe,E as As,a as gs,b as us,c as Is,d as hs,B as ds,A as ze,H as Re,U as es,C as ps,e as Ce,f as Ie,R as Ge,g as Je,P as Ze,h as Oe,T as We,M as Be,i as ts,I as Ee,j as Ps,k as Es,l as Ls,m as $s,n as as,o as qe,p as Te,q as je,D as Pe,r as rs,s as is,t as He,u as Ke,v as Rs}from"./icons-4d10a36e.js";(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const g of document.querySelectorAll('link[rel="modulepreload"]'))o(g);new MutationObserver(g=>{for(const m of g)if(m.type==="childList")for(const p of m.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&o(p)}).observe(document,{childList:!0,subtree:!0});function a(g){const m={};return g.integrity&&(m.integrity=g.integrity),g.referrerPolicy&&(m.referrerPolicy=g.referrerPolicy),g.crossOrigin==="use-credentials"?m.credentials="include":g.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function o(g){if(g.ep)return;g.ep=!0;const m=a(g);fetch(g.href,m)}})();var fs={exports:{}},Ye={};/**
* @license React
* react-jsx-runtime.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/var Ts=t,Ms=Symbol.for("react.element"),Ds=Symbol.for("react.fragment"),Fs=Object.prototype.hasOwnProperty,Os=Ts.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,qs={key:!0,ref:!0,__self:!0,__source:!0};function ys(l,c,a){var o,g={},m=null,p=null;a!==void 0&&(m=""+a),c.key!==void 0&&(m=""+c.key),c.ref!==void 0&&(p=c.ref);for(o in c)Fs.call(c,o)&&!qs.hasOwnProperty(o)&&(g[o]=c[o]);if(l&&l.defaultProps)for(o in c=l.defaultProps,c)g[o]===void 0&&(g[o]=c[o]);return{$$typeof:Ms,type:l,key:m,ref:p,props:g,_owner:Os.current}}Ye.Fragment=Ds;Ye.jsx=ys;Ye.jsxs=ys;fs.exports=Ye;var e=fs.exports,ss={},os=ks;ss.createRoot=os.createRoot,ss.hydrateRoot=os.hydrateRoot;const Us="modulepreload",zs=function(l){return"/"+l},ms={},ls=function(c,a,o){if(!a||a.length===0)return c();const g=document.getElementsByTagName("link");return Promise.all(a.map(m=>{if(m=zs(m),m in ms)return;ms[m]=!0;const p=m.endsWith(".css"),D=p?'[rel="stylesheet"]':"";if(!!o)for(let b=g.length-1;b>=0;b--){const N=g[b];if(N.href===m&&(!p||N.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${m}"]${D}`))return;const v=document.createElement("link");if(v.rel=p?"stylesheet":Us,p||(v.as="script",v.crossOrigin=""),v.href=m,document.head.appendChild(v),p)return new Promise((b,N)=>{v.addEventListener("load",b),v.addEventListener("error",()=>N(new Error(`Unable to preload CSS for ${m}`)))})})).then(()=>c()).catch(m=>{const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=m,window.dispatchEvent(p),!p.defaultPrevented)throw m})},ve="",S={token:localStorage.getItem("ff_token"),adminToken:localStorage.getItem("ff_admin_token"),setToken(l){this.token=l,l?localStorage.setItem("ff_token",l):localStorage.removeItem("ff_token")},setAdminToken(l){this.adminToken=l,l?localStorage.setItem("ff_admin_token",l):localStorage.removeItem("ff_admin_token")},async request(l,c={}){const a={"Content-Type":"application/json",...c.headers};this.token&&(a.Authorization=`Bearer ${this.token}`),c.admin&&this.adminToken&&(a["X-Admin-Token"]=this.adminToken);const o=await fetch(`${ve}${l}`,{...c,headers:a}),g=await o.text();let m=null;try{m=g?JSON.parse(g):null}catch{m={detail:g||o.statusText||"Request failed"}}if(!o.ok)throw new Error(m?.detail||m?.error||o.statusText||"Request failed");return m}};function bs(l){const c=S.token||"";return`${ve}/api/voice/download/${l}?token=${encodeURIComponent(c)}`}const js="ff_image_pending_task_ids";function Xe(){try{const l=JSON.parse(localStorage.getItem(js)||"[]");return Array.isArray(l)?l:[]}catch{return[]}}function ns(l){try{localStorage.setItem(js,JSON.stringify([...new Set(l)]))}catch{}}function Gs(l){const c=Xe();ns([...new Set([...c,...l])])}function Se(l){const c=Xe(),a=new Set(l);ns(c.filter(o=>!a.has(o)))}function xs({message:l,type:c="info",onClose:a}){t.useEffect(()=>{const p=setTimeout(a,4e3);return()=>clearTimeout(p)},[a]);const o={success:{bg:"bg-emerald-500",icon:Ce},error:{bg:"bg-red-500",icon:Ie},info:{bg:"bg-blue-500",icon:Ie},warning:{bg:"bg-amber-500",icon:Ie}},g=o[c]||o.info,m=g.icon;return e.jsx("div",{className:"fixed bottom-6 right-6 z-[100] animate-in slide-in-from-bottom-5 fade-in duration-300",children:e.jsxs("div",{className:`flex items-center gap-3 px-4 py-3 rounded-xl ${g.bg} text-white shadow-lg shadow-black/10`,children:[e.jsx(m,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{className:"text-sm font-medium",children:l}),e.jsx("button",{onClick:a,className:"ml-2 opacity-70 hover:opacity-100 transition-opacity",children:e.jsx(ye,{className:"w-4 h-4"})})]})})}function J({children:l,variant:c="primary",size:a="md",loading:o,disabled:g,className:m="",...p}){const D={primary:"bg-black text-white hover:bg-gray-800",secondary:"bg-gray-100 text-gray-900 hover:bg-gray-200 border border-gray-200",outline:"border border-gray-300 text-gray-700 hover:bg-gray-50",ghost:"text-gray-600 hover:bg-gray-100",danger:"bg-red-500 text-white hover:bg-red-600"},_={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"};return e.jsxs("button",{className:`inline-flex items-center justify-center gap-2 font-medium rounded-lg transition-all disabled:opacity-50 ${D[c]} ${_[a]} ${m}`,disabled:g||o,...p,children:[o&&e.jsx(he,{className:"w-4 h-4 animate-spin"}),l]})}function ke({label:l,error:c,className:a="",...o}){return e.jsxs("div",{className:"space-y-1.5",children:[l&&e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:l}),e.jsx("input",{className:`w-full px-3 py-2.5 border rounded-lg bg-white text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-black/5 focus:border-gray-400 ${c?"border-red-300":"border-gray-200"} ${a}`,...o}),c&&e.jsx("p",{className:"text-sm text-red-500",children:c})]})}function z({children:l,className:c="",...a}){return e.jsx("div",{className:`bg-white rounded-2xl border border-gray-100 shadow-sm ${c}`,...a,children:l})}function $e({open:l,onClose:c,title:a,children:o,size:g="md"}){if(!l)return null;const m={sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl",full:"max-w-6xl"};return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/20 backdrop-blur-sm",onClick:c}),e.jsxs("div",{className:`relative w-full ${m[g]} bg-white rounded-2xl shadow-xl max-h-[90vh] overflow-auto`,children:[e.jsxs("div",{className:"flex items-center justify-between p-5 border-b border-gray-100 sticky top-0 bg-white z-10",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:a}),e.jsx("button",{onClick:c,className:"p-1 rounded-lg hover:bg-gray-100",children:e.jsx(ye,{className:"w-5 h-5 text-gray-500"})})]}),e.jsx("div",{className:"p-5",children:o})]})]})}function vs({tabs:l,value:c,onChange:a}){return e.jsx("div",{className:"flex gap-1 p-1 bg-gray-100 rounded-xl",children:l.map(o=>e.jsx("button",{onClick:()=>a(o.value),className:`flex-1 px-4 py-2 text-sm font-medium rounded-lg transition-all ${c===o.value?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:o.label},o.value))})}function Ns({open:l,onClose:c,src:a,prompt:o,allImages:g=[],items:m,currentIndex:p,onChangeIndex:D}){const[_,v]=t.useState(0),b=Array.isArray(m)&&m.length>0&&typeof p=="number"&&typeof D=="function",N=b?m[p]:null,M=b?N?.allImages||[]:g?.length?g:a?[{data_uri:a,url:a}]:[],W=Array.isArray(M)?M:[],C=W[_]||W[0],f=C?.data_uri||C?.url||(b?W[0]?.data_uri||W[0]?.url:a),q=(b?N?.prompt:o)||"Image preview",V=W.length>1;b&&m.length>1;const H=()=>v(y=>(y-1+W.length)%W.length),ae=()=>v(y=>(y+1)%W.length),te=()=>{v(0),D(Math.max(0,p-1))},ie=()=>{v(0),D(Math.min(m.length-1,p+1))},Y=b&&m.length>1&&p>0,K=b&&m.length>1&&p<m.length-1,ce=V&&_>0,xe=V&&_<W.length-1,de=Y||ce,h=K||xe,A=()=>{Y?te():ce&&H()},O=()=>{K?ie():xe&&ae()};return t.useEffect(()=>{l&&v(0)},[l,b?p:void 0]),l?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:[e.jsx("div",{className:"absolute inset-0",onClick:c,"aria-hidden":"true"}),e.jsxs("div",{className:"relative max-w-4xl w-full max-h-[90vh] flex flex-col bg-white rounded-2xl shadow-2xl overflow-hidden",onClick:y=>y.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b border-gray-100 bg-gray-50/80",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 truncate max-w-[70%]",children:q}),e.jsxs("div",{className:"flex items-center gap-2",children:[V&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[e.jsx("button",{type:"button",onClick:H,className:"p-1.5 rounded-lg hover:bg-gray-200",children:e.jsx(He,{className:"w-4 h-4"})}),e.jsxs("span",{children:[_+1," / ",W.length]}),e.jsx("button",{type:"button",onClick:ae,className:"p-1.5 rounded-lg hover:bg-gray-200",children:e.jsx(Ke,{className:"w-4 h-4"})})]}),b&&m.length>1&&e.jsxs("span",{className:"text-xs text-gray-400",children:[p+1," / ",m.length]}),e.jsx("button",{type:"button",onClick:c,className:"p-2 rounded-lg hover:bg-gray-200 text-gray-600",children:e.jsx(ye,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"relative flex-1 overflow-auto flex items-center justify-center p-4 min-h-[200px] bg-gray-900/5",children:[(de||h)&&e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",onClick:A,disabled:!de,className:"absolute left-2 top-1/2 -translate-y-1/2 z-10 w-12 h-12 rounded-full bg-white/95 hover:bg-white shadow-lg border border-gray-200 flex items-center justify-center text-gray-700 hover:text-black transition-colors disabled:opacity-40 disabled:pointer-events-none","aria-label":"Previous",children:e.jsx(He,{className:"w-6 h-6"})}),e.jsx("button",{type:"button",onClick:O,disabled:!h,className:"absolute right-2 top-1/2 -translate-y-1/2 z-10 w-12 h-12 rounded-full bg-white/95 hover:bg-white shadow-lg border border-gray-200 flex items-center justify-center text-gray-700 hover:text-black transition-colors disabled:opacity-40 disabled:pointer-events-none","aria-label":"Next",children:e.jsx(Ke,{className:"w-6 h-6"})})]}),f&&e.jsx("img",{src:f,alt:q,className:"max-w-full max-h-[70vh] object-contain rounded-lg shadow-lg"})]})]})]}):null}function Vs({onAuth:l,showToast:c}){const[a,o]=t.useState("login"),[g,m]=t.useState(""),[p,D]=t.useState(""),[_,v]=t.useState(""),[b,N]=t.useState(!1),[M,W]=t.useState(!1),[C,f]=t.useState("");t.useEffect(()=>{try{const V=new URLSearchParams(window.location.search).get("ref");V&&(f(V.trim().toUpperCase()),o("register"))}catch{}},[]);const q=async V=>{V.preventDefault(),N(!0);try{const H=a==="login"?"/api/auth/login":"/api/auth/register",ae=a==="login"?{nickname:g,password:p}:{nickname:g,password:p,email:_||null,referral_code:C||null},te=await S.request(H,{method:"POST",body:JSON.stringify(ae)});S.setToken(te.token),l(te.user),c(a==="login"?"Welcome back!":"Account created!","success")}catch(H){c(H.message,"error")}finally{N(!1)}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-white flex",children:[e.jsxs("div",{className:"hidden lg:flex lg:w-1/2 bg-black text-white p-12 flex-col justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-16",children:[e.jsx("div",{className:"w-10 h-10 bg-white rounded-xl flex items-center justify-center",children:e.jsx(Me,{className:"w-6 h-6 text-black"})}),e.jsx("span",{className:"text-xl font-semibold tracking-tight",children:"FiftyFive Labs"})]}),e.jsxs("h1",{className:"text-5xl font-bold leading-tight mb-6",children:["Generate stunning",e.jsx("br",{}),"AI voices instantly"]}),e.jsx("p",{className:"text-lg text-gray-400 max-w-md",children:"Professional AI voice synthesis with ElevenLabs technology. Create natural-sounding speech in seconds."})]}),e.jsx("div",{className:"space-y-6",children:[{icon:De,title:"Natural Voices",desc:"Over 50 professional voices"},{icon:Ve,title:"Lightning Fast",desc:"Generate audio in seconds"},{icon:Fe,title:"API Access",desc:"Integrate into your workflow"}].map((V,H)=>e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-white/10 rounded-xl flex items-center justify-center",children:e.jsx(V.icon,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:V.title}),e.jsx("p",{className:"text-sm text-gray-400",children:V.desc})]})]},H))})]}),e.jsx("div",{className:"flex-1 flex items-center justify-center p-8",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-10 lg:hidden",children:[e.jsx("div",{className:"w-10 h-10 bg-black rounded-xl flex items-center justify-center",children:e.jsx(Me,{className:"w-6 h-6 text-white"})}),e.jsx("span",{className:"text-xl font-semibold tracking-tight",children:"FiftyFive Labs"})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:a==="login"?"Welcome back":"Create an account"}),e.jsx("p",{className:"text-gray-500",children:a==="login"?"Enter your credentials to continue":"Start generating AI voices today"})]}),e.jsx(vs,{tabs:[{value:"login",label:"Sign In"},{value:"register",label:"Sign Up"}],value:a,onChange:o}),e.jsxs("form",{onSubmit:q,className:"mt-6 space-y-4",children:[a==="register"&&C&&e.jsxs("div",{className:"px-3 py-2 rounded-lg border border-gray-200 bg-gray-50 text-sm text-gray-700",children:["Referral: ",e.jsx("span",{className:"font-mono font-semibold",children:C})]}),e.jsx(ke,{label:"Username",placeholder:"Enter your username",value:g,onChange:V=>m(V.target.value),required:!0}),a==="register"&&e.jsx(ke,{label:"Email (optional)",type:"email",placeholder:"your@email.com",value:_,onChange:V=>v(V.target.value)}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:M?"text":"password",placeholder:"••••••••",value:p,onChange:V=>D(V.target.value),required:!0,className:"w-full px-3 py-2.5 border border-gray-200 rounded-lg bg-white text-gray-900 pr-10 focus:outline-none focus:ring-2 focus:ring-black/5"}),e.jsx("button",{type:"button",onClick:()=>W(!M),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400",children:M?e.jsx(As,{className:"w-4 h-4"}):e.jsx(gs,{className:"w-4 h-4"})})]})]}),e.jsx(J,{type:"submit",loading:b,className:"w-full",size:"lg",children:a==="login"?"Sign In":"Create Account"})]})]})})]})}function ws({checked:l,onChange:c,label:a,description:o}){return e.jsxs("label",{className:"flex items-center justify-between cursor-pointer",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:a}),o&&e.jsx("p",{className:"text-xs text-gray-500",children:o})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"checkbox",checked:l,onChange:g=>c(g.target.checked),className:"sr-only"}),e.jsx("div",{className:`w-11 h-6 rounded-full transition-colors ${l?"bg-black":"bg-gray-200"}`,children:e.jsx("div",{className:`absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full shadow transition-transform ${l?"translate-x-5":"translate-x-0"}`})})]})]})}function _s({stats:l}){const[c,a]=t.useState("7d"),[o,g]=t.useState([]),[m,p]=t.useState(!1),D=l?.__mode||"user";t.useEffect(()=>{let C=!0;return(async()=>{p(!0);try{const q=D==="admin"?`/api/admin/usage?period=${c}`:`/api/user/usage?period=${c}`,V=await S.request(q,D==="admin"?{admin:!0}:{});if(!C)return;g(V.series||[])}catch{C&&g([])}finally{C&&p(!1)}})(),()=>{C=!1}},[c,D]);const _=Math.max(...o.map(C=>C.chars),1),v=o.reduce((C,f)=>C+(f.chars||0),0),N=[...o.map(C=>C.chars||0)].sort((C,f)=>f-C)[1]||0,M=_>0&&N>0&&_/N>5?Math.max(_*.7,N*2):_,W=t.useMemo(()=>{const C=c==="30d"?28:c==="7d"?40:50;return Math.max(520,(o.length||0)*C)},[o.length,c]);return e.jsxs(z,{className:"p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-5",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Usage Statistics"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Characters generated over time"})]}),e.jsx("div",{className:"flex gap-1 p-1 bg-gray-100 rounded-lg",children:[{id:"today",label:"Today"},{id:"7d",label:"7 Days"},{id:"30d",label:"30 Days"}].map(C=>e.jsx("button",{onClick:()=>a(C.id),className:`px-3 py-1.5 text-xs font-medium rounded-md transition-all ${c===C.id?"bg-white text-gray-900 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:C.label},C.id))})]}),e.jsx("div",{className:"overflow-x-auto overflow-y-hidden -mx-2 px-2",children:e.jsx("div",{className:"h-48 flex items-end gap-0.5 relative pb-6",style:{minWidth:W},children:m?e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx(he,{className:"w-5 h-5 animate-spin text-gray-300"})}):o.map((C,f)=>{const q=Math.max(8,C.chars/M*100);return e.jsxs("div",{className:"flex-1 flex flex-col items-center gap-1 min-w-0",children:[e.jsx("div",{className:"w-full flex flex-col justify-end h-36 relative",children:e.jsxs("div",{className:"relative group w-full cursor-pointer",style:{height:`${q}%`},children:[e.jsx("div",{className:"w-full h-full bg-gradient-to-t from-gray-900 to-gray-600 rounded-t-sm transition-all hover:from-black hover:to-gray-700 hover:shadow-lg min-h-[2px]"}),(()=>{const V=o.length>=20?3:2,H=f<V,ae=f>=o.length-V,te=H?"left-0 translate-x-0":ae?"right-0 translate-x-0":"left-1/2 -translate-x-1/2";return e.jsx("div",{className:`pointer-events-none opacity-0 group-hover:opacity-100 transition-all duration-200 absolute bottom-0 translate-y-full mt-2 ${te} whitespace-nowrap z-30`,children:e.jsx("div",{className:"px-3 py-2 rounded-lg bg-gray-900 text-white text-sm font-medium shadow-2xl border-2 border-gray-700 backdrop-blur-sm",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-gray-400",children:[C.label,":"]}),e.jsx("span",{className:"font-bold text-white",children:(C.chars||0).toLocaleString()}),e.jsx("span",{className:"text-gray-400 text-xs",children:"chars"})]})})})})()]})}),e.jsx("div",{className:"w-full h-6 flex items-start justify-center",children:e.jsx("span",{className:"text-gray-400 text-center text-[10px]",title:`${C.label}: ${(C.chars||0).toLocaleString()} chars`,children:C.label})})]},f)})})}),e.jsxs("div",{className:"flex items-center justify-center gap-6 mt-4 pt-4 border-t border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-sm bg-gradient-to-t from-gray-900 to-gray-600"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Characters"})]}),e.jsxs("div",{className:"text-xs text-gray-400",children:["Total: ",e.jsx("span",{className:"font-semibold text-gray-700",children:v.toLocaleString()})]})]})]})}function Js({user:l,refreshUser:c,showToast:a,onGoToLibrary:o}){const[g,m]=t.useState(""),[p,D]=t.useState(!1),[_,v]=t.useState([]),[b,N]=t.useState(()=>{try{return JSON.parse(localStorage.getItem("ff_completed_tasks")||"[]")}catch{return[]}}),[M,W]=t.useState(()=>localStorage.getItem("ff_voice_id")||"21m00Tcm4TlvDq8ikWAM"),[C,f]=t.useState(()=>localStorage.getItem("ff_model_id")||"eleven_multilingual_v2"),[q,V]=t.useState(()=>parseFloat(localStorage.getItem("ff_stability"))||.5),[H,ae]=t.useState(()=>parseFloat(localStorage.getItem("ff_similarity"))||.75),[te,ie]=t.useState(()=>parseFloat(localStorage.getItem("ff_style"))||0),[Y,K]=t.useState(()=>localStorage.getItem("ff_speaker_boost")!=="false"),[ce,xe]=t.useState(()=>parseFloat(localStorage.getItem("ff_speed"))||1);t.useEffect(()=>{localStorage.setItem("ff_voice_id",M)},[M]),t.useEffect(()=>{localStorage.setItem("ff_model_id",C)},[C]),t.useEffect(()=>{localStorage.setItem("ff_stability",q.toString())},[q]),t.useEffect(()=>{localStorage.setItem("ff_similarity",H.toString())},[H]),t.useEffect(()=>{localStorage.setItem("ff_style",te.toString())},[te]),t.useEffect(()=>{localStorage.setItem("ff_speaker_boost",Y.toString())},[Y]),t.useEffect(()=>{localStorage.setItem("ff_speed",ce.toString())},[ce]);const[de,h]=t.useState([]),[A,O]=t.useState([]),[y,T]=t.useState(!1),[I,X]=t.useState("");t.useEffect(()=>{(async()=>{try{const w=localStorage.getItem("ff_voice_favorites_data");if(w)try{const s=JSON.parse(w);Array.isArray(s)&&s.length>0&&h(s)}catch{}const G=(await S.request("/api/voices/library")).voices||[];O(G);const ne=JSON.parse(localStorage.getItem("ff_voice_favorites")||"[]");if(ne.length>0){const s=G.filter(L=>ne.includes(L.voice_id));s.length>0&&h(L=>{const E=new Set(L.map(me=>me.voice_id)),se=s.filter(me=>!E.has(me.voice_id)),ue=[...L,...se];return localStorage.setItem("ff_voice_favorites_data",JSON.stringify(ue)),ue})}}catch{}})();const k=w=>{if(w.key==="ff_voice_favorites_data"&&w.newValue)try{h(JSON.parse(w.newValue))}catch{}};return window.addEventListener("storage",k),()=>window.removeEventListener("storage",k)},[]),A.filter(i=>!I||i.name?.toLowerCase().includes(I.toLowerCase())||i.labels?.gender?.toLowerCase().includes(I.toLowerCase()));const Q=[{id:"eleven_multilingual_v2",name:"Eleven Multilingual v2",desc:"High quality, 29 languages"},{id:"eleven_turbo_v2",name:"Eleven Turbo v2",desc:"Fast English"},{id:"eleven_turbo_v2_5",name:"Eleven Turbo v2.5",desc:"Fast multilingual"},{id:"eleven_flash_v2",name:"Eleven Flash v2",desc:"Ultra-fast"},{id:"eleven_flash_v2_5",name:"Eleven Flash v2.5",desc:"Fastest, 32 languages"},{id:"eleven_v3",name:"Eleven English v3",desc:"Latest, most emotive"}],U=t.useRef(new Set),Z=t.useCallback((i,k,w=null)=>{const P=i.id;return U.current.has(P)?!1:(U.current.add(P),v(G=>G.filter(ne=>ne.id!==P)),N(G=>{if(G.some(E=>E.id===P))return G;const L=[{...i,id:P,taskId:P,status:k,progress:k==="completed"?100:i.progress,completedAt:Date.now(),textPreview:i.textPreview||i.text?.slice(0,50),charCount:i.charCount||0,error:w},...G].slice(0,20);return localStorage.setItem("ff_completed_tasks",JSON.stringify(L)),L}),!0)},[]),oe=t.useCallback(async()=>{try{const i=await S.request("/api/tasks/active");if(i.tasks){const k=i.tasks.filter(w=>!U.current.has(w.id)).map(w=>({id:w.id,taskId:w.id,status:w.status,text:w.prompt,textPreview:w.prompt?.slice(0,50)+(w.prompt?.length>50?"...":""),charCount:w.char_count,progress:w.progress||0,chunks:null,totalChunks:null,queue_position:w.queue_position,createdAt:w.created_at_ms}));v(k)}}catch{}},[]),le=t.useCallback(async()=>{const i=_.filter(w=>w.status==="processing"||w.status==="queued"||w.status==="pending");if(i.length===0)return;const k=await Promise.allSettled(i.map(async w=>{try{const P=await S.request(`/api/voice/status/${w.id}`);return{task:w,data:P,success:!0,notFound:!1}}catch(P){return P.message?.includes("404")||P.message?.includes("not found")||P.message?.includes("Not Found")?{task:w,error:P,success:!1,notFound:!0}:{task:w,error:P,success:!1,notFound:!1}}}));for(const w of k){if(w.status!=="fulfilled")continue;const{task:P,data:G,success:ne,notFound:s}=w.value;if(s){v(L=>L.filter(E=>E.id!==P.id));continue}ne&&(G.status==="completed"?Z(P,"completed")&&(a("Audio generated!","success"),c()):G.status==="failed"||G.status==="cancelled"?Z(P,G.status,G.error||"Generation failed")&&a(G.error||"Generation failed","error"):v(L=>L.map(E=>E.id===P.id?{...E,status:G.status||E.status,progress:G.progress||0,chunks:G.chunks_completed,totalChunks:G.chunks_total,queue_position:G.queue_position,voicer_task_id:G.voicer_task_id||E.voicer_task_id}:E)))}},[_,a,c,Z]);t.useEffect(()=>{oe()},[]),t.useEffect(()=>{const i=_.filter(P=>P.status==="processing"||P.status==="queued"||P.status==="pending");if(i.length===0)return;let k=1e3;i.some(P=>P.status==="processing")?k=800:i.some(P=>P.status==="pending"||P.status==="queued")&&(k=1200),le();const w=setInterval(le,k);return()=>clearInterval(w)},[_,le]);const pe=async i=>{try{const k=await S.request(`/api/tasks/${i}/cancel`,{method:"POST"});a(`Task cancelled. ${k.credits_refunded} credits refunded`,"success"),oe(),c()}catch(k){a(k.message,"error")}},[be,Ne]=t.useState(!1),ge=async()=>{if(be)return;if(!g.trim()){a("Please enter text to synthesize","warning");return}const i=g.trim().length,k=(l?.credit_packages||[]).reduce((w,P)=>w+(P.credits_remaining||0),0);if(k<i){a(`Insufficient credits. Need ${i.toLocaleString()}, have ${k.toLocaleString()}`,"error");return}Ne(!0);try{const w={text:g.trim(),voice_id:M,model_id:C,voice_settings:{stability:q,similarity_boost:H,style:te,use_speaker_boost:Y,speed:ce}};await S.request("/api/voice/synthesize",{method:"POST",body:JSON.stringify(w)}),m(""),a("Task started!","success"),c(),setTimeout(oe,100),setTimeout(le,400),setTimeout(le,1e3),setTimeout(le,2e3)}catch(w){a(w.message,"error")}finally{Ne(!1)}},[n,j]=t.useState({}),[r,d]=t.useState(null),x=t.useRef(null),R=async(i,k=3)=>{for(let w=0;w<k;w++)try{const P=await fetch(`${ve}/api/voice/download/${i}`,{headers:{Authorization:`Bearer ${S.token}`}});if(P.status===410)throw new Error("File expired");if(P.status===503){if(w<k-1){await new Promise(G=>setTimeout(G,2e3));continue}throw new Error("Audio preparing, please try again in a moment")}if(!P.ok)throw new Error("Failed to load audio");return P}catch(P){if(w===k-1)throw P;await new Promise(G=>setTimeout(G,1e3))}throw new Error("Failed after retries")},$=async i=>{if(i.id){if(r===i.id){x.current?.pause(),d(null);return}try{a("Loading audio...","info");const k=bs(i.id);x.current&&(x.current.src=k,await x.current.play(),d(i.id))}catch(k){a(k.message||"Failed to play audio","error")}}},u=async i=>{if(i.id){j(k=>({...k,[i.id]:0}));try{const k=await R(i.id),w=k.headers.get("content-length"),P=w?parseInt(w,10):0,G=k.body.getReader(),ne=[];let s=0;for(;;){const{done:ue,value:me}=await G.read();if(ue)break;if(ne.push(me),s+=me.length,P>0){const Ue=Math.round(s/P*100);j(we=>({...we,[i.id]:Ue}))}}const L=new Blob(ne,{type:"audio/mpeg"}),E=URL.createObjectURL(L),se=document.createElement("a");se.href=E,se.download=`voice_${i.id}.mp3`,se.click(),URL.revokeObjectURL(E),a("Downloaded!","success")}catch(k){a(k.message,"error")}finally{j(k=>{const{[i.id]:w,...P}=k;return P})}}},F=i=>{U.current.delete(i),N(k=>{const w=k.filter(P=>P.id!==i);return localStorage.setItem("ff_completed_tasks",JSON.stringify(w)),w})},B=()=>{U.current.clear(),N([]),localStorage.setItem("ff_completed_tasks",JSON.stringify([]))},ee=_,[,re]=t.useState(0);return t.useEffect(()=>{const i=setInterval(()=>re(k=>k+1),6e4);return()=>clearInterval(i)},[]),e.jsxs("div",{className:"max-w-6xl mx-auto grid lg:grid-cols-3 gap-6",children:[e.jsx("audio",{ref:x,onEnded:()=>d(null),onPause:()=>d(null),onError:()=>{d(null),a("Failed to play audio","error")}}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs(z,{className:"p-5",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:"Text to Synthesize"}),e.jsx("textarea",{value:g,onChange:i=>m(i.target.value),placeholder:"Enter the text you want to convert to speech...",rows:6,className:"w-full px-3 py-2.5 border border-gray-200 rounded-xl bg-white text-gray-900 resize-none focus:outline-none focus:ring-2 focus:ring-black/5"}),e.jsxs("div",{className:"mt-2 flex justify-between items-center text-xs",children:[e.jsxs("span",{className:"text-gray-400",children:[g.length.toLocaleString()," characters"]}),e.jsxs("span",{className:`font-medium ${(()=>{const i=l.credit_packages?.reduce((k,w)=>k+w.credits_remaining,0)||0;return g.length>i?"text-red-500":"text-gray-500"})()}`,children:["Cost: ",g.length.toLocaleString()," credits"]})]}),e.jsx(J,{onClick:ge,className:"w-full mt-4",size:"lg",disabled:be||!g.trim(),children:be?e.jsxs(e.Fragment,{children:[e.jsx(he,{className:"w-4 h-4 animate-spin"})," Processing..."]}):ee.length>0?e.jsxs(e.Fragment,{children:[e.jsx(Oe,{className:"w-4 h-4"})," Add to Queue"]}):e.jsxs(e.Fragment,{children:[e.jsx(De,{className:"w-4 h-4"})," Generate Voice"]})})]}),e.jsxs(z,{className:"p-5 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Voice"}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>T(!y),className:"w-full px-3 py-2.5 text-left rounded-lg border border-gray-200 bg-white hover:border-gray-300 transition-all flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-3",children:(()=>{const i=A.find(w=>w.voice_id===M)||de.find(w=>w.voice_id===M),k=i?.labels?.gender||i?.gender||"";return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-white text-xs font-medium ${k==="female"?"bg-pink-500":k==="male"?"bg-blue-500":"bg-emerald-500"}`,children:e.jsx(Be,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:i?.name||"Select Voice"}),e.jsxs("p",{className:"text-xs text-gray-500 font-mono",children:[M?.slice(0,20),"..."]})]})]})})()}),e.jsx(qe,{className:`w-4 h-4 text-gray-400 transition-transform ${y?"rotate-180":""}`})]}),y&&e.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-80 overflow-hidden",children:[e.jsx("div",{className:"p-2 border-b border-gray-100",children:e.jsxs("div",{className:"relative",children:[e.jsx(Je,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search by name or ID...",value:I,onChange:i=>X(i.target.value),className:"w-full pl-8 pr-3 py-2 text-sm border border-gray-200 rounded-lg focus:outline-none focus:border-gray-400"})]})}),e.jsxs("div",{className:"overflow-y-auto max-h-60",children:[e.jsxs("button",{onClick:()=>{T(!1),o&&o()},className:"w-full px-3 py-2.5 text-left hover:bg-gray-50 border-b border-gray-100 flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center",children:e.jsx(ts,{className:"w-4 h-4 text-gray-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Browse Voice Library"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Find more voices"})]})]}),de.filter(i=>!I||i.name?.toLowerCase().includes(I.toLowerCase())||i.voice_id?.toLowerCase().includes(I.toLowerCase())).map(i=>e.jsxs("button",{onClick:()=>{W(i.voice_id),T(!1)},className:`w-full px-3 py-2.5 text-left hover:bg-gray-50 flex items-center justify-between ${M===i.voice_id?"bg-gray-50":""}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-white text-xs font-medium ${i.labels?.gender==="female"?"bg-pink-500":i.labels?.gender==="male"?"bg-blue-500":"bg-purple-500"}`,children:e.jsx(Be,{className:"w-4 h-4"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Te,{className:"w-3 h-3 text-amber-500 fill-current"}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:i.name})]}),e.jsxs("p",{className:"text-xs text-gray-400 font-mono",children:[i.voice_id?.slice(0,20),"..."]})]})]}),e.jsx(Te,{className:"w-4 h-4 text-amber-500 fill-current"})]},i.voice_id)),de.length===0&&e.jsxs("div",{className:"px-3 py-4 text-center text-sm text-gray-400",children:["No favorite voices yet.",e.jsx("br",{}),"Add them in Voice Library ⭐"]})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Model"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:Q.map(i=>e.jsxs("button",{onClick:()=>f(i.id),className:`px-3 py-2 text-center rounded-lg border transition-all ${C===i.id?"border-black bg-black text-white":"border-gray-200 hover:border-gray-300 bg-white"}`,children:[e.jsx("p",{className:`text-sm font-medium ${C===i.id?"text-white":"text-gray-900"}`,children:i.name}),e.jsx("p",{className:`text-xs ${C===i.id?"text-gray-300":"text-gray-500"}`,children:i.desc})]},i.id))})]}),e.jsxs("button",{onClick:()=>D(!p),className:"flex items-center gap-2 text-sm text-gray-500 hover:text-gray-700",children:[e.jsx(qe,{className:`w-4 h-4 transition-transform ${p?"rotate-180":""}`}),"Voice Settings"]}),p&&e.jsxs("div",{className:"space-y-5 pt-4 border-t border-gray-100",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Stability"}),e.jsxs("span",{className:"text-sm text-gray-500",children:[Math.round(q*100),"%"]})]}),e.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:q,onChange:i=>V(parseFloat(i.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-black"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mt-1",children:[e.jsx("span",{children:"More variable"}),e.jsx("span",{children:"More stable"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Clarity + Similarity"}),e.jsxs("span",{className:"text-sm text-gray-500",children:[Math.round(H*100),"%"]})]}),e.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:H,onChange:i=>ae(parseFloat(i.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-black"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mt-1",children:[e.jsx("span",{children:"Low"}),e.jsx("span",{children:"High"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Style Exaggeration"}),e.jsxs("span",{className:"text-sm text-gray-500",children:[Math.round(te*100),"%"]})]}),e.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:te,onChange:i=>ie(parseFloat(i.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-black"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mt-1",children:[e.jsx("span",{children:"None"}),e.jsx("span",{children:"Exaggerated"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Speed"}),e.jsxs("span",{className:"text-sm text-gray-500",children:[ce.toFixed(2),"x"]})]}),e.jsx("input",{type:"range",min:"0.5",max:"2",step:"0.05",value:ce,onChange:i=>xe(parseFloat(i.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-black"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mt-1",children:[e.jsx("span",{children:"0.5x"}),e.jsx("span",{children:"2x"})]})]}),e.jsx("div",{className:"pt-2",children:e.jsx(ws,{checked:Y,onChange:K,label:"Speaker Boost",description:"Increases similarity to the original speaker"})})]})]})]}),e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[ee.length>0&&e.jsxs(z,{className:"p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700",children:ee.length===1?"Current Task":`Queue (${ee.length})`}),ee.filter(i=>i.status==="pending").length>0&&e.jsx("button",{onClick:async()=>{const i=ee.filter(k=>k.status==="pending");for(const k of i)try{await S.request(`/api/tasks/${k.id}/cancel`,{method:"POST"})}catch{}a("Pending tasks cancelled","info"),oe(),c()},className:"text-xs text-red-500 hover:text-red-700",children:"Cancel all pending"})]}),e.jsx("div",{className:"space-y-3",children:ee.map((i,k)=>e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[i.status==="processing"?e.jsx(he,{className:"w-4 h-4 animate-spin text-blue-500"}):i.status==="queued"?e.jsx(je,{className:"w-4 h-4 text-orange-500 animate-pulse"}):e.jsx(je,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-sm font-medium",children:i.status==="processing"?"Processing...":i.status==="queued"?`Queued${i.queue_position?` #${i.queue_position}`:""}`:i.status==="pending"?"Pending...":`#${k+1} ${i.status||"pending"}`})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-xs text-gray-400",children:[(i.charCount||0).toLocaleString()," chars"]}),e.jsx("button",{onClick:()=>pe(i.id),className:"p-1 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded transition-colors",title:"Cancel task",children:e.jsx(ye,{className:"w-4 h-4"})})]})]}),e.jsx("p",{className:"text-xs text-gray-500 truncate mb-2",children:i.textPreview||i.text?.slice(0,50)}),i.status==="processing"&&e.jsx("div",{className:"h-1.5 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-black transition-all",style:{width:`${i.progress||0}%`}})}),(i.status==="queued"||i.status==="pending")&&e.jsx("div",{className:"h-1.5 bg-orange-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-orange-500 animate-pulse",style:{width:"100%"}})})]},i.id))})]}),e.jsxs(z,{className:"p-5 min-h-[300px] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Recent"}),b.length>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:async()=>{const i=b.filter(k=>k.status==="completed"&&!(k.completedAt&&Date.now()>k.completedAt+432e5));if(i.length===0){a("No completed tasks to download","info");return}try{a(`Preparing ${i.length} file${i.length!==1?"s":""}…`,"info");const k=(await ls(()=>import("./jszip.min-efe84dac.js").then(s=>s.j),["assets/jszip.min-efe84dac.js","assets/vendor-a6b94228.js"])).default,w=new k;let P=0;for(const s of i)try{const E=await(await R(s.id)).blob();w.file(`voice_${s.id}.mp3`,E),P++}catch{}if(P===0){a("Could not fetch any audio files","error");return}const G=await w.generateAsync({type:"blob"}),ne=document.createElement("a");ne.href=URL.createObjectURL(G),ne.download=`voice_recent_${Date.now()}.zip`,ne.click(),URL.revokeObjectURL(ne.href),a(`Downloaded ${P} file${P!==1?"s":""}`,"success")}catch(k){a(k?.message||"Download failed","error")}},className:"text-xs font-medium text-gray-500 hover:text-gray-700 transition-colors flex items-center gap-1",children:[e.jsx(Pe,{className:"w-3.5 h-3.5"})," Download all"]}),e.jsx("button",{onClick:B,className:"text-xs font-medium text-red-500 hover:text-red-700 transition-colors",children:"Clear all"})]})]}),b.length===0?e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-center py-8",children:[e.jsx("div",{className:"w-14 h-14 rounded-2xl bg-gray-100 flex items-center justify-center mb-4",children:e.jsx(De,{className:"w-7 h-7 text-gray-400"})}),e.jsx("p",{className:"text-sm font-medium text-gray-500 mb-1",children:"No completed tasks"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Finished generations will appear here"})]}):e.jsx("div",{className:"space-y-3 overflow-y-auto max-h-[420px] pr-1 scrollbar-thin scrollbar-track-transparent scrollbar-thumb-gray-300 hover:scrollbar-thumb-gray-400",style:{scrollbarGutter:"stable"},children:b.slice().reverse().map(i=>{const k=i.completedAt?i.completedAt+432e5:null,w=k&&Date.now()>k,P=k?cs(k):null;return e.jsxs("div",{className:`p-3.5 rounded-xl border transition-shadow hover:shadow-sm ${w?"bg-gray-50/80 border-gray-200":i.status==="completed"?"bg-emerald-50/80 border-emerald-200/60":"bg-red-50/80 border-red-200/60"}`,children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[e.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2 py-0.5 rounded-full text-xs font-medium ${w?"bg-gray-200/60 text-gray-500":i.status==="completed"?"bg-emerald-200/60 text-emerald-700":"bg-red-200/60 text-red-700"}`,children:[w?e.jsx(je,{className:"w-3 h-3"}):i.status==="completed"?e.jsx(Ce,{className:"w-3 h-3"}):e.jsx(Ie,{className:"w-3 h-3"}),w?"Expired":i.status==="completed"?"Ready":"Failed"]}),e.jsxs("span",{className:"text-xs text-gray-400 tabular-nums",children:[i.charCount?.toLocaleString()??0," ch"]})]}),e.jsx("p",{className:"text-xs text-gray-700 line-clamp-2 mb-2",children:i.textPreview}),i.status==="completed"&&!w&&P&&e.jsxs("p",{className:"text-xs text-amber-600 flex items-center gap-1 mb-2",children:[e.jsx(je,{className:"w-3 h-3"})," ",P]}),i.error&&e.jsx("p",{className:"text-xs text-red-600 mb-2",children:i.error}),e.jsxs("div",{className:"flex gap-2",children:[i.status==="completed"&&!w?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>$(i),className:`flex-1 flex items-center justify-center gap-1.5 px-2.5 py-2 rounded-xl text-xs font-medium transition-all ${r===i.id?"bg-emerald-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:r===i.id?e.jsx(rs,{className:"w-3.5 h-3.5"}):e.jsx(is,{className:"w-3.5 h-3.5"})}),e.jsx("button",{onClick:()=>u(i),disabled:n[i.id]!==void 0,className:"flex-1 flex items-center justify-center gap-1.5 px-2.5 py-2 bg-gray-900 text-white rounded-xl text-xs font-medium hover:bg-black disabled:opacity-50 transition-all relative overflow-hidden",children:n[i.id]!==void 0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute inset-0 bg-emerald-500/30 transition-all",style:{width:`${n[i.id]}%`}}),e.jsx(he,{className:"w-3.5 h-3.5 animate-spin relative z-10"}),e.jsxs("span",{className:"relative z-10",children:[n[i.id],"%"]})]}):e.jsx(Pe,{className:"w-3.5 h-3.5"})})]}):w?e.jsx("span",{className:"text-xs text-gray-400 flex-1 text-center py-2",children:"Unavailable"}):null,e.jsx("button",{onClick:()=>F(i.id),className:"p-2 rounded-xl text-gray-400 hover:text-gray-600 hover:bg-gray-100 transition-colors",children:e.jsx(ye,{className:"w-4 h-4"})})]})]},i.id)})})]})]}),y&&e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>T(!1)})]})}function cs(l){const c=Date.now(),a=l-c;if(a<=0)return null;const o=Math.floor(a/(1e3*60*60)),g=Math.floor(a%(1e3*60*60)/(1e3*60));return o>0?`${o}h ${g}m`:`${g}m`}function Ws({showToast:l}){const[c,a]=t.useState("voice"),[o,g]=t.useState([]),[m,p]=t.useState(1),[D,_]=t.useState(0),[v,b]=t.useState(!0),[,N]=t.useState(0),[M,W]=t.useState(null),[C,f]=t.useState({}),[q,V]=t.useState(new Set),[H,ae]=t.useState(null),te=t.useRef(null),ie=c==="image"?25:12,Y=t.useCallback(async()=>{b(!0);try{const h=c==="image"?"&type=image":"&type=voice",A=await S.request(`/api/history?page=${m}&limit=${ie}${h}`);g(A.jobs||[]),_(A.total||0)}catch(h){l(h.message,"error")}finally{b(!1)}},[m,c,ie,l]);t.useEffect(()=>{Y()},[Y]);const K=t.useMemo(()=>{if(c!=="image")return[];const h=Date.now();return o.filter(A=>{let O={};try{A.metadata_json&&(O=typeof A.metadata_json=="string"?JSON.parse(A.metadata_json):A.metadata_json)}catch{return!1}return O?.type!=="image"||A.status!=="completed"||A.expires_at_ms&&h>A.expires_at_ms?!1:!!(O.data_uri||O.result)}).map(A=>{let O={};try{A.metadata_json&&(O=typeof A.metadata_json=="string"?JSON.parse(A.metadata_json):A.metadata_json)}catch{}const y=O.all_images||[{data_uri:O.data_uri||O.result,url:O.data_uri||O.result}];return{jobId:A.id,prompt:A.prompt,allImages:y}})},[o,c]);t.useEffect(()=>{const h=setInterval(()=>N(A=>A+1),6e4);return()=>clearInterval(h)},[]);const ce=async(h,A=3)=>{for(let O=0;O<A;O++)try{const y=await fetch(`${ve}/api/voice/download/${h}`,{headers:{Authorization:`Bearer ${S.token}`}});if(y.status===410)throw new Error("File expired");if(y.status===503){if(O<A-1){await new Promise(T=>setTimeout(T,2e3));continue}throw new Error("Audio preparing, please try again in a moment")}if(!y.ok)throw new Error("Failed to load audio");return y}catch(y){if(O===A-1)throw y;await new Promise(T=>setTimeout(T,1e3))}throw new Error("Failed after retries")},xe=async h=>{if(M===h){te.current?.pause(),W(null);return}try{l("Loading audio...","info");const A=bs(h);te.current&&(te.current.src=A,await te.current.play(),W(h))}catch(A){l(A.message||"Failed to play audio","error")}},de=async h=>{f(A=>({...A,[h]:0}));try{const A=await ce(h),O=A.headers.get("content-length"),y=O?parseInt(O,10):0,T=A.body.getReader(),I=[];let X=0;for(;;){const{done:oe,value:le}=await T.read();if(oe)break;if(I.push(le),X+=le.length,y>0){const pe=Math.round(X/y*100);f(be=>({...be,[h]:pe}))}else f(pe=>({...pe,[h]:-1}))}const Q=new Blob(I,{type:"audio/mpeg"}),U=URL.createObjectURL(Q),Z=document.createElement("a");Z.href=U,Z.download=`voice_${h}.mp3`,Z.click(),URL.revokeObjectURL(U),l("Downloaded!","success")}catch(A){l(A.message,"error")}finally{f(A=>{const{[h]:O,...y}=A;return y})}};return e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsx("audio",{ref:te,onEnded:()=>W(null),onPause:()=>W(null),onError:()=>{W(null),l("Failed to play audio","error")}}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 tracking-tight",children:"All History"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Voice and image generations from your account"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[e.jsx(vs,{tabs:[{value:"voice",label:"Voice"},{value:"image",label:"Image"}],value:c,onChange:h=>{a(h),p(1),V(new Set)}}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"inline-flex items-center px-3 py-1.5 rounded-full text-xs font-medium bg-gray-100 text-gray-600",children:[D," ",c==="image"?"images":"items"]}),e.jsxs(J,{variant:"secondary",size:"sm",onClick:Y,disabled:v,children:[e.jsx(Ge,{className:`w-4 h-4 ${v?"animate-spin":""}`})," Refresh"]})]})]}),v?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[e.jsx(he,{className:"w-10 h-10 animate-spin text-gray-300 mb-4"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Loading history…"})]}):o.length===0?e.jsxs(z,{className:"p-16 text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl bg-gray-100 flex items-center justify-center mx-auto mb-5",children:e.jsx(Re,{className:"w-8 h-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No generations yet"}),e.jsx("p",{className:"text-sm text-gray-500 max-w-sm mx-auto",children:"Your voice and image generations will appear here."})]}):e.jsxs(e.Fragment,{children:[c==="image"&&q.size>0&&e.jsxs("div",{className:"mb-5 px-5 py-4 rounded-2xl border border-gray-200 bg-gray-50/80 flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[q.size," image",q.size!==1?"s":""," selected"]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(J,{size:"sm",variant:"secondary",onClick:async()=>{try{const h=(await ls(()=>import("./jszip.min-efe84dac.js").then(y=>y.j),["assets/jszip.min-efe84dac.js","assets/vendor-a6b94228.js"])).default,A=new h;let O=0;for(const y of q){const T=o.find(Q=>Q.id===y);if(!T)continue;let I={};try{T.metadata_json&&(I=typeof T.metadata_json=="string"?JSON.parse(T.metadata_json):T.metadata_json)}catch{continue}const X=I.data_uri||I.result;if(X)if(X.startsWith("data:")){const U=await(await fetch(X)).blob();A.file(`image_${y}.png`,U),O++}else if(I.all_images&&I.all_images.length>1)for(let Q=0;Q<I.all_images.length;Q++){const U=I.all_images[Q],Z=U.data_uri||U.url||X,le=await(await fetch(Z)).blob();A.file(`image_${y}_${Q+1}.png`,le),O++}else{const U=await(await fetch(X)).blob();A.file(`image_${y}.png`,U),O++}}if(O>0){const y=await A.generateAsync({type:"blob"}),T=document.createElement("a");T.href=URL.createObjectURL(y),T.download=`images_${Date.now()}.zip`,T.click(),URL.revokeObjectURL(T.href),l(`Downloaded ${O} image${O!==1?"s":""}`,"success"),V(new Set)}}catch{l("Failed to create ZIP archive","error")}},children:[e.jsx(Pe,{className:"w-4 h-4"})," Download"]}),e.jsxs(J,{size:"sm",variant:"secondary",className:"text-red-600 hover:text-red-700 hover:bg-red-50 border-red-200",onClick:async()=>{if(confirm(`Delete ${q.size} image${q.size!==1?"s":""}?`)){for(const h of q)try{await S.request(`/api/jobs/${h}`,{method:"DELETE"})}catch{}l(`Deleted ${q.size} image${q.size!==1?"s":""}`,"success"),V(new Set),Y()}},children:[e.jsx(We,{className:"w-4 h-4"})," Delete"]})]})]}),e.jsx("div",{className:`grid gap-5 ${c==="image"?"grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5":"sm:grid-cols-2 lg:grid-cols-3"}`,children:o.map(h=>{const A=h.expires_at_ms&&Date.now()>h.expires_at_ms,O=h.expires_at_ms?cs(h.expires_at_ms):null;let y={};try{h.metadata_json&&(y=typeof h.metadata_json=="string"?JSON.parse(h.metadata_json):h.metadata_json)}catch{}const T=y&&y.type==="image";if(c==="image"&&!T||c==="voice"&&T)return null;const I=q.has(h.id);y.all_images||(y.data_uri||y.result);const X=y.data_uri||y.result;return e.jsxs(z,{className:`overflow-hidden group transition-all ${A?"opacity-65":""} ${I?"ring-2 ring-black ring-offset-2":"hover:shadow-md"}`,children:[T&&h.status==="completed"&&!A&&X?e.jsxs("div",{className:"relative aspect-square bg-gray-100",children:[c==="image"&&e.jsx("div",{className:"absolute top-3 left-3 z-10",children:e.jsx("input",{type:"checkbox",checked:I,onChange:Q=>{const U=new Set(q);Q.target.checked?U.add(h.id):U.delete(h.id),V(U)},className:"w-5 h-5 rounded-md border-gray-300 text-black focus:ring-2 focus:ring-black/20",onClick:Q=>Q.stopPropagation()})}),e.jsx("img",{src:X,alt:h.prompt,className:"w-full h-full object-cover cursor-pointer hover:scale-[1.02] transition-transform duration-200",onClick:()=>{const Q=K.findIndex(U=>U.jobId===h.id);Q>=0&&ae({list:K,index:Q})}}),e.jsxs("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity flex items-end justify-center pb-3 gap-2",children:[e.jsxs("button",{onClick:Q=>{Q.stopPropagation();const U=K.findIndex(Z=>Z.jobId===h.id);U>=0&&ae({list:K,index:U})},className:"px-3 py-1.5 rounded-lg bg-white/95 text-gray-900 text-xs font-medium hover:bg-white flex items-center gap-1.5",children:[e.jsx(gs,{className:"w-3.5 h-3.5"})," Preview"]}),e.jsxs("button",{onClick:Q=>{Q.stopPropagation();const U=document.createElement("a");U.href=X,U.download=`image_${h.id}.png`,U.click()},className:"px-3 py-1.5 rounded-lg bg-white/95 text-gray-900 text-xs font-medium hover:bg-white flex items-center gap-1.5",children:[e.jsx(Pe,{className:"w-3.5 h-3.5"})," Download"]})]})]}):null,e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 mb-2",children:[e.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2 py-0.5 rounded-full text-xs font-medium ${A?"bg-gray-100 text-gray-500":h.status==="completed"?"bg-emerald-50 text-emerald-700":h.status==="failed"?"bg-red-50 text-red-600":h.status==="cancelled"?"bg-gray-100 text-gray-600":h.status==="processing"?"bg-blue-50 text-blue-600":"bg-gray-100 text-gray-500"}`,children:[A?e.jsx(je,{className:"w-3 h-3"}):h.status==="completed"?e.jsx(Ce,{className:"w-3 h-3"}):h.status==="processing"?e.jsx(he,{className:"w-3 h-3 animate-spin"}):h.status==="failed"||h.status==="cancelled"?e.jsx(Ie,{className:"w-3 h-3"}):e.jsx(je,{className:"w-3 h-3"}),A?"Expired":h.status]}),!T&&h.width>0&&e.jsxs("span",{className:"text-xs text-gray-400 tabular-nums",children:[h.width.toLocaleString()," ch"]})]}),e.jsx("p",{className:"text-sm text-gray-900 line-clamp-2 mb-3",children:h.prompt}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-400 mb-3 min-h-[1.25rem]",children:[e.jsx("span",{children:new Date(h.created_at_ms).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})}),h.status==="completed"&&!A&&O?e.jsxs("span",{className:"flex items-center gap-1 text-amber-600",children:[e.jsx(je,{className:"w-3 h-3"})," ",O]}):e.jsx("span",{className:"invisible",children:"—"})]}),!T&&h.status==="completed"&&!A?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>xe(h.id),className:`flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 rounded-xl text-sm font-medium transition-all ${M===h.id?"bg-emerald-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:M===h.id?e.jsxs(e.Fragment,{children:[e.jsx(rs,{className:"w-4 h-4"})," Pause"]}):e.jsxs(e.Fragment,{children:[e.jsx(is,{className:"w-4 h-4"})," Play"]})}),e.jsx("button",{onClick:()=>de(h.id),disabled:C[h.id]!==void 0,className:"flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 bg-gray-900 text-white rounded-xl text-sm font-medium hover:bg-black disabled:opacity-50 transition-all relative overflow-hidden",children:C[h.id]!==void 0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute inset-0 bg-emerald-500/30 transition-all",style:{width:C[h.id]>=0?`${C[h.id]}%`:"100%"}}),e.jsx(he,{className:"w-4 h-4 animate-spin relative z-10"}),e.jsx("span",{className:"relative z-10 ml-1",children:C[h.id]>=0?`${C[h.id]}%`:"…"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Pe,{className:"w-4 h-4"})," Download"]})})]}):A?e.jsx("div",{className:"py-2.5 text-center rounded-xl bg-gray-50 text-xs text-gray-400",children:"Unavailable"}):null]})]},h.id)})}),D>ie&&e.jsxs("div",{className:"flex items-center justify-center gap-3 mt-8 pt-6 border-t border-gray-100",children:[e.jsxs(J,{variant:"secondary",size:"sm",disabled:m===1,onClick:()=>p(h=>h-1),children:[e.jsx(He,{className:"w-4 h-4"})," Previous"]}),e.jsxs("span",{className:"text-sm text-gray-500",children:["Page ",m," of ",Math.ceil(D/ie)||1]}),e.jsxs(J,{variant:"secondary",size:"sm",disabled:m*ie>=D,onClick:()=>p(h=>h+1),children:["Next ",e.jsx(Ke,{className:"w-4 h-4"})]})]})]}),e.jsx(Ns,{open:!!H,onClose:()=>ae(null),src:H?.list?void 0:H?.src,prompt:H?.list?void 0:H?.prompt,allImages:H?.list?void 0:H?.allImages,items:H?.list,currentIndex:H?.index,onChangeIndex:H?.list?h=>ae(A=>A?{...A,index:h}:null):void 0})]})}function Bs({showToast:l}){const[c,a]=t.useState([]),[o,g]=t.useState(!1),[m,p]=t.useState(""),[D,_]=t.useState(!1),[v,b]=t.useState({gender:"",age:"",accent:"",language:"",use_case:""}),[N,M]=t.useState("all"),[W,C]=t.useState(null),[f,q]=t.useState(1),[V,H]=t.useState(0),[ae,te]=t.useState(!1),[ie,Y]=t.useState(null),[K,ce]=t.useState(()=>{try{return JSON.parse(localStorage.getItem("ff_voice_favorites")||"[]")}catch{return[]}}),[xe,de]=t.useState(()=>{try{return JSON.parse(localStorage.getItem("ff_voice_favorites_data")||"[]")}catch{return[]}}),h=t.useRef(null),A=t.useRef(null),O=20,y={gender:{label:"Gender",options:[{value:"male",label:"Male"},{value:"female",label:"Female"}]},age:{label:"Age",options:[{value:"young",label:"Young"},{value:"middle_aged",label:"Middle Aged"},{value:"old",label:"Old"}]},accent:{label:"Accent",options:[{value:"american",label:"American"},{value:"british",label:"British"},{value:"australian",label:"Australian"},{value:"indian",label:"Indian"},{value:"irish",label:"Irish"},{value:"italian",label:"Italian"},{value:"spanish",label:"Spanish"},{value:"french",label:"French"},{value:"german",label:"German"},{value:"polish",label:"Polish"},{value:"russian",label:"Russian"}]},language:{label:"Language",options:[{value:"en",label:"English"},{value:"uk",label:"Ukrainian"},{value:"pl",label:"Polish"},{value:"de",label:"German"},{value:"fr",label:"French"},{value:"es",label:"Spanish"},{value:"it",label:"Italian"},{value:"pt",label:"Portuguese"},{value:"ru",label:"Russian"},{value:"ja",label:"Japanese"},{value:"ko",label:"Korean"},{value:"zh",label:"Chinese"}]},use_case:{label:"Use Case",options:[{value:"narration",label:"Narration"},{value:"news",label:"News"},{value:"audiobook",label:"Audiobook"},{value:"conversational",label:"Conversational"},{value:"characters_animation",label:"Characters"},{value:"meditation",label:"Meditation"},{value:"gaming",label:"Gaming"}]}},T=Object.values(v).some(r=>r!=="")||m.trim()!=="",I=Object.values(v).filter(r=>r!=="").length+(m.trim()?1:0);t.useEffect(()=>{const r=()=>Y(null);if(ie)return document.addEventListener("click",r),()=>document.removeEventListener("click",r)},[ie]);const X=t.useCallback(async(r=0,d=!1)=>{g(!0);try{const x=new URLSearchParams;x.set("page_size","100"),x.set("page",String(r)),m.trim()&&x.set("search",m.trim()),v.gender&&x.set("gender",v.gender),v.age&&x.set("age",v.age),v.accent&&x.set("accent",v.accent),v.language&&x.set("language",v.language),v.use_case&&x.set("use_case",v.use_case);const R=localStorage.getItem("ff_token"),u=await(await fetch(`/api/elevenlabs/shared-voices?${x.toString()}`,{headers:R?{Authorization:`Bearer ${R}`}:{}})).json();if(u.ok&&u.voices){const F=u.voices.map(B=>({voice_id:String(B.voice_id),name:B.name||"Unknown",category:B.category||"",description:B.description||"",preview_url:B.preview_url||"",gender:B.gender||"",age:B.age||"",accent:B.accent||"",use_case:B.use_case||"",descriptive:B.descriptive||"",language:B.language||"",labels:B.labels||{}}));d?a(B=>[...B,...F]):(a(F),q(1)),te(u.has_more||!1),H(r)}else u.error&&l(u.error,"error")}catch{l("Failed to load voices","error")}g(!1)},[m,v,l]),Q=t.useRef(!1);t.useEffect(()=>{Q.current||(Q.current=!0,X(0,!1))},[]);const U=t.useRef(m),Z=t.useRef(JSON.stringify(v));t.useEffect(()=>{const r=JSON.stringify(v);if(!(U.current===m&&Z.current===r))return U.current=m,Z.current=r,A.current&&clearTimeout(A.current),A.current=setTimeout(()=>{X(0,!1)},500),()=>clearTimeout(A.current)},[m,v,X]),t.useEffect(()=>{localStorage.setItem("ff_voice_favorites",JSON.stringify(K)),localStorage.setItem("ff_voice_favorites_data",JSON.stringify(xe))},[K,xe]),t.useEffect(()=>{const r=new Set(K);let d=[];try{d=JSON.parse(localStorage.getItem("ff_voice_favorites_data")||"[]")}catch{}const x=c.filter(u=>r.has(u.voice_id)),R=new Set(x.map(u=>u.voice_id)),$=d.filter(u=>r.has(u.voice_id)&&!R.has(u.voice_id));de([...x,...$])},[c,K]);const oe=()=>{b({gender:"",age:"",accent:"",language:"",use_case:""}),p(""),Y(null)},le=r=>{const d=r.voice_id;ce(x=>x.includes(d)?x.filter(R=>R!==d):[...x,d]),de(x=>{let R;return x.find($=>$.voice_id===d)?R=x.filter($=>$.voice_id!==d):R=[...x,r],localStorage.setItem("ff_voice_favorites_data",JSON.stringify(R)),R})},pe=async r=>{if(W===r.voice_id){h.current?.pause(),C(null);return}const d=r.preview_url;if(d)try{h.current&&(h.current.src=d,await h.current.play(),C(r.voice_id))}catch{l("Failed to play preview","error")}else l("No preview available","warning")},be=r=>{navigator.clipboard.writeText(r),l("Voice ID copied!","success")},Ne=(r,d=22)=>r?r.length>d?r.slice(0,d)+"...":r:"Unknown",ge=t.useMemo(()=>N==="favorites"?xe||[]:c,[c,N,xe]),n=Math.ceil(ge.length/O),j=ge.slice((f-1)*O,f*O);return t.useEffect(()=>{q(1)},[N]),e.jsxs("div",{className:"max-w-7xl mx-auto space-y-3",children:[e.jsx("audio",{ref:h,onEnded:()=>C(null)}),e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-3",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-bold text-gray-900",children:"Voice Library"}),e.jsx("p",{className:"text-gray-500 text-xs",children:"Browse and preview voices from ElevenLabs"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>M("all"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${N==="all"?"bg-black text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["All Voices",e.jsx("span",{className:`ml-2 px-1.5 py-0.5 rounded text-xs ${N==="all"?"bg-white/20":"bg-gray-200"}`,children:c.length})]}),e.jsxs("button",{onClick:()=>M("favorites"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all flex items-center gap-1 ${N==="favorites"?"bg-black text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[e.jsx(Te,{className:`w-4 h-4 ${N==="favorites"?"":"text-amber-500"}`}),"Favorites",e.jsx("span",{className:`ml-1 px-1.5 py-0.5 rounded text-xs ${N==="favorites"?"bg-white/20":"bg-gray-200"}`,children:xe.length})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:items-stretch",children:[e.jsxs("div",{className:"flex-1 relative h-10",children:[e.jsx(Je,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search by name, ID or description...",value:m,onChange:r=>p(r.target.value),className:"w-full h-full pl-10 pr-4 border border-gray-200 rounded-xl bg-white text-sm text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-black/5 focus:border-gray-300"})]}),e.jsxs("button",{onClick:()=>_(!D),className:`h-10 px-4 rounded-xl border flex items-center justify-center gap-2 transition-all whitespace-nowrap text-sm ${D||T?"bg-black text-white border-black":"bg-white border-gray-200 text-gray-700 hover:border-gray-300"}`,children:[e.jsx(Rs,{className:"w-4 h-4"}),"Filters",I>0&&e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${D||T?"bg-white/20":"bg-black text-white"}`,children:I})]})]}),D&&e.jsxs(z,{className:"p-4",onClick:r=>r.stopPropagation(),children:[e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 gap-3",children:Object.keys(y).map(r=>{const d=y[r],x=ie===r,R=v[r],$=R?d.options.find(u=>u.value===R)?.label:null;return e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:u=>{u.stopPropagation(),Y(x?null:r)},className:`w-full px-3 py-2.5 rounded-xl text-sm text-left flex items-center justify-between transition-all ${R?"bg-black text-white":"bg-gray-100 border border-gray-200 text-gray-700 hover:border-gray-300"}`,children:[e.jsx("span",{className:"truncate",children:$||d.label}),e.jsx(qe,{className:`w-4 h-4 ml-2 flex-shrink-0 transition-transform ${x?"rotate-180":""}`})]}),x&&e.jsx("div",{className:"absolute z-50 mt-2 w-full bg-white border border-gray-200 rounded-xl shadow-lg overflow-hidden",children:e.jsxs("div",{className:"max-h-[200px] overflow-y-auto",children:[e.jsxs("button",{onClick:()=>{b(u=>({...u,[r]:""})),Y(null)},className:`w-full px-4 py-2.5 text-left text-sm hover:bg-gray-50 flex items-center justify-between ${R?"text-gray-700":"bg-gray-50 text-black font-medium"}`,children:[e.jsx("span",{children:"All"}),!R&&e.jsx(Ce,{className:"w-4 h-4"})]}),d.options.map(u=>e.jsxs("button",{onClick:()=>{b(F=>({...F,[r]:u.value})),Y(null)},className:`w-full px-4 py-2.5 text-left text-sm hover:bg-gray-50 flex items-center justify-between ${R===u.value?"bg-gray-50 text-black font-medium":"text-gray-700"}`,children:[e.jsx("span",{children:u.label}),R===u.value&&e.jsx(Ce,{className:"w-4 h-4"})]},u.value))]})})]},r)})}),T&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-100 flex items-center justify-between flex-wrap gap-2",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[m.trim()&&e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full bg-gray-100 text-gray-700 text-xs font-medium",children:['"',m,'"',e.jsx("button",{onClick:()=>p(""),className:"hover:text-black",children:e.jsx(ye,{className:"w-3 h-3"})})]}),Object.entries(v).filter(([r,d])=>d).map(([r,d])=>e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full bg-gray-100 text-gray-700 text-xs font-medium",children:[y[r].options.find(x=>x.value===d)?.label,e.jsx("button",{onClick:()=>b(x=>({...x,[r]:""})),className:"hover:text-black",children:e.jsx(ye,{className:"w-3 h-3"})})]},r))]}),e.jsxs("button",{onClick:oe,className:"px-4 py-2 rounded-xl bg-gray-100 hover:bg-gray-200 text-gray-700 text-sm font-medium flex items-center gap-2 transition-all",children:[e.jsx(ye,{className:"w-4 h-4"}),"Clear all"]})]})]}),e.jsx("div",{className:"flex items-center justify-between text-sm text-gray-500",children:e.jsxs("span",{children:[ge.length," voice",ge.length!==1?"s":""," ",ae&&"(more available)"]})}),o&&c.length===0?e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsx(he,{className:"w-8 h-8 animate-spin text-gray-400"})}):N==="favorites"&&xe.length===0?e.jsxs(z,{className:"p-12 text-center",children:[e.jsx(Te,{className:"w-12 h-12 text-gray-200 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No favorites yet"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Add voices to favorites by clicking the star icon"})]}):ge.length===0?e.jsxs(z,{className:"p-12 text-center",children:[e.jsx(Je,{className:"w-12 h-12 text-gray-200 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No voices found"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Try different filters or search term"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:j.map(r=>e.jsxs(z,{className:"p-4 hover:shadow-lg transition-all group",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx("div",{className:`w-11 h-11 rounded-full flex-shrink-0 flex items-center justify-center text-white text-sm font-semibold ${(()=>{const d=(r.labels?.gender||r.gender||"").toLowerCase();return d==="female"?"bg-pink-500":d==="male"?"bg-blue-500":"bg-purple-500"})()}`,children:r.name?.charAt(0)?.toUpperCase()||"V"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-gray-900 text-sm truncate",title:r.name,children:Ne(r.name)}),e.jsxs("p",{className:"text-xs text-gray-500 font-mono truncate",children:[r.voice_id?.slice(0,16),"..."]})]}),e.jsx("button",{onClick:()=>le(r),className:`p-1.5 rounded-lg transition-all ${K.includes(r.voice_id)?"text-amber-500 bg-amber-50":"text-gray-300 hover:text-amber-500 hover:bg-amber-50"}`,children:e.jsx(Te,{className:`w-5 h-5 ${K.includes(r.voice_id)?"fill-current":""}`})})]}),e.jsx("div",{className:"flex flex-wrap gap-1.5 mb-3 min-h-[26px]",children:(()=>{const d=r.labels||{},x=d.gender||r.gender||"",R=d.age||r.age||"",$=d.accent||r.accent||"",u=d.use_case||r.use_case||"";return e.jsxs(e.Fragment,{children:[x&&e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${x.toLowerCase()==="female"?"bg-pink-100 text-pink-700":x.toLowerCase()==="male"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:x}),R&&e.jsx("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-600 rounded-full text-xs",children:R}),$&&e.jsx("span",{className:"px-2 py-0.5 bg-emerald-50 text-emerald-700 rounded-full text-xs",children:$}),u&&e.jsx("span",{className:"px-2 py-0.5 bg-purple-50 text-purple-700 rounded-full text-xs",children:u}),!x&&!R&&!$&&!u&&e.jsx("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-500 rounded-full text-xs",children:"voice"})]})})()}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>pe(r),className:`flex-1 flex items-center justify-center gap-2 py-2.5 rounded-xl text-sm font-medium transition-all ${W===r.voice_id?"bg-emerald-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:W===r.voice_id?e.jsxs(e.Fragment,{children:[e.jsx(rs,{className:"w-4 h-4"})," Stop"]}):e.jsxs(e.Fragment,{children:[e.jsx(is,{className:"w-4 h-4"})," Preview"]})}),e.jsx("button",{onClick:()=>be(r.voice_id),className:"px-4 py-2.5 bg-black text-white rounded-xl text-sm font-medium hover:bg-gray-800 transition-all",title:"Copy Voice ID",children:e.jsx(as,{className:"w-4 h-4"})})]})]},r.voice_id))}),(n>1||ae)&&e.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-3 pt-6 mt-6 border-t border-gray-100",children:[e.jsxs(J,{variant:"secondary",size:"sm",disabled:f<=1,onClick:()=>q(r=>Math.max(1,r-1)),children:[e.jsx(He,{className:"w-4 h-4"})," Previous"]}),e.jsxs("span",{className:"text-sm text-gray-500",children:["Page ",f," of ",n]}),e.jsx(J,{variant:"secondary",size:"sm",disabled:f===n&&!ae||f===n&&ae&&o,onClick:async()=>{f===n&&ae?(await X(V+1,!0),q(r=>r+1)):q(r=>Math.min(n,r+1))},children:f===n&&ae&&o?e.jsx(he,{className:"w-4 h-4 animate-spin"}):e.jsxs(e.Fragment,{children:["Next ",e.jsx(Ke,{className:"w-4 h-4"})]})})]})]})]})}function Hs({user:l,refreshUser:c,showToast:a}){const[o,g]=t.useState(()=>localStorage.getItem("ff_image_prompt")||""),[m,p]=t.useState(()=>localStorage.getItem("ff_image_aspect_ratio")||"IMAGE_ASPECT_RATIO_LANDSCAPE"),[D,_]=t.useState(()=>localStorage.getItem("ff_image_model")||"IMAGEN_3_5"),[v,b]=t.useState(()=>localStorage.getItem("ff_image_seed")||""),[N,M]=t.useState(()=>parseInt(localStorage.getItem("ff_num_images"),10)||1),[W,C]=t.useState(()=>localStorage.getItem("ff_image_show_advanced")==="true"),[f,q]=t.useState(()=>{const n=localStorage.getItem("ff_image_show_models");return n===null?!0:n==="true"}),[V,H]=t.useState([]),[ae,te]=t.useState(!1),[ie,Y]=t.useState(()=>{try{const n=localStorage.getItem("ff_completed_image_tasks"),j=JSON.parse(n||"[]");if(!Array.isArray(j))return[];const r=new Set;return j.filter(d=>!d||!d.id||r.has(d.id)?!1:(r.add(d.id),!0)).slice(0,20)}catch{return[]}}),K=t.useRef(new Set),ce=t.useRef([]),[xe,de]=t.useState({}),[h,A]=t.useState(null),[O,y]=t.useState({}),T=t.useRef({});t.useEffect(()=>{localStorage.setItem("ff_image_prompt",o)},[o]),t.useEffect(()=>{localStorage.setItem("ff_image_aspect_ratio",m)},[m]),t.useEffect(()=>{localStorage.setItem("ff_image_model",D)},[D]),t.useEffect(()=>{localStorage.setItem("ff_image_seed",v)},[v]),t.useEffect(()=>{localStorage.setItem("ff_num_images",N.toString())},[N]),t.useEffect(()=>{localStorage.setItem("ff_image_show_advanced",W?"true":"false")},[W]),t.useEffect(()=>{localStorage.setItem("ff_image_show_models",f?"true":"false")},[f]),t.useEffect(()=>{(async()=>{try{const j=await S.request("/api/model-pricing");if(j.pricing){const r={};j.pricing.forEach(d=>{r[d.model_id]=d.credits_per_image}),de(r)}}catch{de({IMAGEN_3_5:1,GEM_PIX:1,GEM_PIX_2:2})}})()},[]);const I=t.useCallback(n=>{const j=new Set;return n.filter(r=>j.has(r.id)?!1:(j.add(r.id),!0))},[]),X=t.useCallback(n=>{try{const j=(n||[]).slice(0,20).map(r=>({id:r.id,prompt:String(r.prompt||"").slice(0,500),status:r.status,error:r.error||null,completedAt:r.completedAt||Date.now()}));localStorage.setItem("ff_completed_image_tasks",JSON.stringify(j))}catch(j){try{if(j?.name==="QuotaExceededError"){const r=(n||[]).slice(0,5).map(d=>({id:d.id,prompt:String(d.prompt||"").slice(0,500),status:d.status,error:d.error||null,completedAt:d.completedAt||Date.now()}));localStorage.setItem("ff_completed_image_tasks",JSON.stringify(r))}else localStorage.setItem("ff_completed_image_tasks","[]")}catch{}}},[]),Q=t.useCallback(n=>{try{X(n)}catch{}},[X]),U=t.useCallback(async()=>{try{const n=await S.request("/api/image/tasks/active");if(n.tasks){const j=n.tasks.map(u=>({id:u.id,prompt:u.prompt,status:u.status,progress:u.progress||0,createdAt:u.created_at_ms,result:u.result,queue_position:u.queue_position})),r=j.map(u=>u.id),d=Xe(),x=[...new Set([...d,...r])];ns(x);const R=x.filter(u=>!r.includes(u));for(const u of R){if(K.current.has(u)){Se([u]);continue}try{const F=await S.request(`/api/image/status/${u}`);if(F.status==="completed"||F.status==="failed"||F.status==="cancelled"){K.current.add(u),Se([u]);const B=F.status,ee={id:u,prompt:F.prompt??"",status:B,result:B==="completed"?F.data_uri||F.result:null,allImages:B==="completed"?F.all_images||(F.data_uri||F.result?[{data_uri:F.data_uri||F.result}]:[]):[],error:B!=="completed"?F.error||(B==="cancelled"?"Cancelled":"Failed"):null,completedAt:Date.now()};Y(re=>re.some(i=>i.id===u)?re:I([ee,...re]).slice(0,20)),B==="completed"?a("Image generated!","success"):B==="cancelled"?a("Task cancelled","info"):a(F.error||"Generation failed","error"),c()}}catch{Se([u])}}ce.current=r;const $=j.filter(u=>!K.current.has(u.id));H($)}else{ce.current=[],H([]);const j=Xe();for(const r of j){if(K.current.has(r)){Se([r]);continue}try{const d=await S.request(`/api/image/status/${r}`);if(d.status==="completed"||d.status==="failed"||d.status==="cancelled"){K.current.add(r),Se([r]);const x=d.status,R={id:r,prompt:d.prompt??"",status:x,result:x==="completed"?d.data_uri||d.result:null,allImages:x==="completed"?d.all_images||(d.data_uri||d.result?[{data_uri:d.data_uri||d.result}]:[]):[],error:x!=="completed"?d.error||(x==="cancelled"?"Cancelled":"Failed"):null,completedAt:Date.now()};Y($=>$.some(u=>u.id===r)?$:I([R,...$]).slice(0,20)),x==="completed"?a("Image generated!","success"):x==="cancelled"?a("Task cancelled","info"):a(d.error||"Generation failed","error"),c()}}catch{Se([r])}}}}catch{}},[I,a,c]);t.useLayoutEffect(()=>{K.current.clear(),ie.forEach(n=>{n&&n.id&&K.current.add(n.id)})},[]),t.useEffect(()=>{Q(ie)},[ie,Q]);const Z=t.useRef(new Set),oe=t.useCallback(async n=>{if(!(T.current[n]||Z.current.has(n))){Z.current.add(n);try{const j=await fetch(`${ve}/api/jobs/${n}/image`,{headers:S.token?{Authorization:`Bearer ${S.token}`}:{}});if(!j.ok)return;const r=await j.blob(),d=URL.createObjectURL(r);T.current[n]=d,y(x=>({...x,[n]:d}))}catch{}finally{Z.current.delete(n)}}},[]);t.useEffect(()=>{const n=Date.now();ie.forEach(j=>{if(!j||j.status!=="completed"||!j.id||j.result)return;const r=(j.completedAt||0)+12*60*60*1e3;n>r||oe(j.id)})},[ie,oe]),t.useEffect(()=>()=>{Object.values(T.current).forEach(n=>{try{URL.revokeObjectURL(n)}catch{}}),T.current={}},[]),t.useEffect(()=>{U();const n=setInterval(U,2e3);return()=>clearInterval(n)},[U]);const le=async n=>{try{const j=await S.request(`/api/tasks/${n}/cancel`,{method:"POST"});a(`Task cancelled. ${j.credits_refunded} credits refunded`,"success"),U(),c()}catch(j){a(j.message||"Failed to cancel task","error")}},pe=t.useCallback(async()=>{const n=V.filter(r=>r.status==="processing"||r.status==="pending"||r.status==="queued");if(n.length===0)return;const j=await Promise.allSettled(n.map(async r=>{try{const d=await S.request(`/api/image/status/${r.id}`);return{task:r,data:d,success:!0}}catch(d){return{task:r,error:d,success:!1}}}));for(const r of j){if(r.status!=="fulfilled")continue;const{task:d,data:x,success:R}=r.value;if(R)if(x.status==="completed"){if(K.current.has(d.id))continue;K.current.add(d.id),Se([d.id]),H($=>{const u=$.filter(F=>F.id!==d.id);return ce.current=u.map(F=>F.id),u}),Y($=>{if($.some(re=>re.id===d.id))return $;const u=x.data_uri||x.result,F=x.all_images||(u?[{data_uri:u}]:[]),B={id:d.id,prompt:d.prompt,status:"completed",result:u,allImages:F,completedAt:Date.now()};return I([B,...$]).slice(0,20)}),a("Image generated!","success"),c()}else if(x.status==="failed"||x.status==="cancelled"){if(K.current.has(d.id))continue;K.current.add(d.id),Se([d.id]),H($=>{const u=$.filter(F=>F.id!==d.id);return ce.current=u.map(F=>F.id),u}),Y($=>{if($.some(F=>F.id===d.id))return $;const u={id:d.id,prompt:d.prompt,status:x.status,error:x.error||(x.status==="cancelled"?"Cancelled by user":"Generation failed"),completedAt:Date.now()};return I([u,...$]).slice(0,20)}),a(x.error||(x.status==="cancelled"?"Task cancelled":"Generation failed"),x.status==="cancelled"?"info":"error"),c()}else H($=>$.map(u=>u.id===d.id?{...u,status:x.status,progress:x.progress||0,queue_position:x.queue_position}:u))}},[V,a,c,I]);t.useEffect(()=>{if(V.length===0)return;const n=setInterval(pe,1e3);return()=>clearInterval(n)},[V,pe]);const be=async()=>{if(ae)return;if(!o.trim()){a("Please enter a prompt","warning");return}const n=o.trim().split(`
`).filter(x=>x.trim().length>0);if(n.length===0){a("Please enter at least one prompt","warning");return}te(!0);const j=setTimeout(()=>te(!1),2e3),r=[];for(const x of n)for(let R=0;R<N;R++){const $={provider:"imaginator",prompt:x.trim(),aspect_ratio:m,model:D,...v&&{seed:parseInt(v)+R}};r.push({promise:S.request("/api/image/generate",{method:"POST",body:JSON.stringify($)}),prompt:x.trim()})}const d=r.map(x=>x.promise);Promise.allSettled(d).then(async x=>{let R=0,$=0;const u=[],F=[];for(let re=0;re<x.length;re++){const i=x[re],k=r[re].prompt;if(i.status==="fulfilled"&&(i.value?.status==="completed"||i.value?.ok&&i.value?.task_id&&(i.value?.data_uri||i.value?.result))){const P=i.value,G=P.task_id;if(G&&!K.current.has(G)){K.current.add(G);const ne=P.data_uri||P.result,s=P.all_images||(ne?[{data_uri:ne}]:[]),L={id:G,prompt:P.prompt||k,status:"completed",result:ne,allImages:s,completedAt:Date.now()};Y(E=>E.some(se=>se.id===G)?E:I([L,...E]).slice(0,20)),R++}G&&F.push(G)}else if(i.status==="rejected"){$++;const P=i.reason?.message||"Generation failed";a(P,"error");const G=`fail-${Date.now()}-${re}-${Math.random().toString(36).slice(2,9)}`;K.current.add(G),u.push({id:G,prompt:k,status:"failed",error:P,completedAt:Date.now()})}else i.status==="fulfilled"&&i.value?.task_id&&F.push(i.value.task_id)}F.length>0&&Gs(F),u.length>0&&Y(re=>I([...u,...re]).slice(0,20)),await U();let B=0;try{B=(await S.request("/api/image/tasks/active")).tasks?.length||0}catch{}B===0&&R===0&&$===x.length&&(g(""),b(""));const ee=r.length;$<x.length&&(R>0?a(R===1?"Image generated!":`${R} images generated!`,"success"):B>0?a(ee>1?`Added ${ee} to queue!`:"Added to queue!","success"):a(ee>1?`Started generating ${ee} images!`:"Image generation started!","success")),c(),B>0&&(setTimeout(()=>U(),400),setTimeout(()=>U(),1200))}).catch(x=>{const R=x?.message||"",$=/503|service unavailable|unavailable/i.test(R);a($?"Image generation unavailable. Add Imaginator/VoidAI/Naga API keys in Admin.":R||"Generation failed","error")}).finally(()=>{clearTimeout(j),te(!1)})},Ne=async n=>{let j=n.result||O[n.id];if(!j)try{const d=await fetch(`${ve}/api/jobs/${n.id}/image`,{headers:S.token?{Authorization:`Bearer ${S.token}`}:{}});if(!d.ok){a("Image unavailable or expired","error");return}const x=await d.blob();j=URL.createObjectURL(x)}catch(d){a(d?.message||"Download failed","error");return}const r=document.createElement("a");r.href=j,r.download=`image_${n.id}.png`,r.click(),j.startsWith("blob:")&&URL.revokeObjectURL(j)},ge=V;return e.jsxs("div",{className:"max-w-6xl mx-auto grid lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2 space-y-6",children:e.jsxs(z,{className:"p-5",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:"Image Generation"}),e.jsx("textarea",{value:o,onChange:n=>g(n.target.value),placeholder:"Describe the image you want to generate...",rows:6,className:"w-full px-3 py-2.5 border border-gray-200 rounded-xl bg-white text-gray-900 resize-none focus:outline-none focus:ring-2 focus:ring-black/5"}),e.jsx("div",{className:"mt-2 flex justify-between items-center text-xs",children:(()=>{const j=o.trim().split(`
`).filter(R=>R.trim().length>0).length||0,r=xe[D]||1,d=j*N,x=d*r;return j===0?e.jsx("span",{className:"text-gray-400",children:"Enter prompt(s) to see cost"}):e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-gray-600",children:[j," prompt",j>1?"s":""," × ",N," image",N>1?"s":""," = ",d," image",d>1?"s":""]}),e.jsxs("span",{className:"font-semibold text-gray-900",children:["Cost: ",x," credit",x!==1?"s":""]})]})})()}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Aspect Ratio"}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("button",{onClick:()=>p("IMAGE_ASPECT_RATIO_LANDSCAPE"),className:`px-3 py-2 text-center rounded-lg border transition-all ${m==="IMAGE_ASPECT_RATIO_LANDSCAPE"?"border-black bg-black text-white":"border-gray-200 hover:border-gray-300 bg-white"}`,children:[e.jsx("p",{className:`text-sm font-medium ${m==="IMAGE_ASPECT_RATIO_LANDSCAPE"?"text-white":"text-gray-900"}`,children:"Landscape"}),e.jsx("p",{className:`text-xs ${m==="IMAGE_ASPECT_RATIO_LANDSCAPE"?"text-gray-300":"text-gray-500"}`,children:"16:9"})]}),e.jsxs("button",{onClick:()=>p("IMAGE_ASPECT_RATIO_PORTRAIT"),className:`px-3 py-2 text-center rounded-lg border transition-all ${m==="IMAGE_ASPECT_RATIO_PORTRAIT"?"border-black bg-black text-white":"border-gray-200 hover:border-gray-300 bg-white"}`,children:[e.jsx("p",{className:`text-sm font-medium ${m==="IMAGE_ASPECT_RATIO_PORTRAIT"?"text-white":"text-gray-900"}`,children:"Portrait"}),e.jsx("p",{className:`text-xs ${m==="IMAGE_ASPECT_RATIO_PORTRAIT"?"text-gray-300":"text-gray-500"}`,children:"9:16"})]}),e.jsxs("button",{onClick:()=>p("IMAGE_ASPECT_RATIO_SQUARE"),className:`px-3 py-2 text-center rounded-lg border transition-all ${m==="IMAGE_ASPECT_RATIO_SQUARE"?"border-black bg-black text-white":"border-gray-200 hover:border-gray-300 bg-white"}`,children:[e.jsx("p",{className:`text-sm font-medium ${m==="IMAGE_ASPECT_RATIO_SQUARE"?"text-white":"text-gray-900"}`,children:"Square"}),e.jsx("p",{className:`text-xs ${m==="IMAGE_ASPECT_RATIO_SQUARE"?"text-gray-300":"text-gray-500"}`,children:"1:1"})]})]})]}),e.jsxs("button",{onClick:()=>q(!f),className:"flex items-center gap-2 text-sm text-gray-500 hover:text-gray-700",children:[e.jsx(qe,{className:`w-4 h-4 transition-transform ${f?"rotate-180":""}`}),"Model"]}),f&&e.jsx("div",{className:"space-y-3 pt-4 border-t border-gray-100",children:e.jsx("div",{className:"grid grid-cols-3 gap-2",children:[{id:"IMAGEN_3_5",name:"Imagen 3.5",desc:"High quality",defaultCredits:1},{id:"GEM_PIX",name:"Nano Banana",desc:"High quality",defaultCredits:1},{id:"GEM_PIX_2",name:"Nano Banana Pro",desc:"High quality",defaultCredits:2},{id:"gpt-image-1",name:"GPT Image 1",desc:"High quality",defaultCredits:1},{id:"gpt-image-1.5",name:"GPT Image 1.5",desc:"High quality",defaultCredits:1},{id:"NAGA_DALLE3",name:"DALL·E 3",desc:"High quality",defaultCredits:1},{id:"NAGA_FLUX",name:"Flux Schnell",desc:"Fast",defaultCredits:1}].map(n=>{const j=xe[n.id]??n.defaultCredits??1,r=D===n.id;return e.jsxs("button",{onClick:()=>_(n.id),className:`px-3 py-2.5 text-center rounded-lg border transition-all flex flex-col items-center justify-center gap-0.5 ${r?"border-black bg-black text-white":"border-gray-200 hover:border-gray-300 bg-white"}`,children:[e.jsx("p",{className:`text-sm font-medium ${r?"text-white":"text-gray-900"}`,children:n.name}),e.jsx("p",{className:`text-xs ${r?"text-gray-300":"text-gray-500"}`,children:n.desc}),e.jsxs("span",{className:`inline-flex items-center rounded-md px-1.5 py-0.5 text-[10px] font-medium mt-0.5 ${r?"bg-white/20 text-white":"bg-gray-100 text-gray-600"}`,children:[j," ",j===1?"credit":"credits","/img"]})]},n.id)})})}),e.jsxs("button",{onClick:()=>C(!W),className:"flex items-center gap-2 text-sm text-gray-500 hover:text-gray-700",children:[e.jsx(qe,{className:`w-4 h-4 transition-transform ${W?"rotate-180":""}`}),"Image Settings"]}),W&&e.jsxs("div",{className:"space-y-5 pt-4 border-t border-gray-100",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Number of Images"}),e.jsx("span",{className:"text-sm text-gray-500",children:N})]}),e.jsx("input",{type:"range",min:"1",max:"10",step:"1",value:N,onChange:n=>M(parseInt(n.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-black"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mt-1",children:[e.jsx("span",{children:"1"}),e.jsx("span",{children:"10"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Seed (Optional)"}),e.jsx(ke,{type:"number",placeholder:"Leave empty for random",value:v,onChange:n=>b(n.target.value)}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Seed for reproducible results"})]})]})]}),e.jsx(J,{onClick:be,className:"w-full mt-4",size:"lg",disabled:ae||!o.trim(),children:ae?e.jsxs(e.Fragment,{children:[e.jsx(he,{className:"w-4 h-4 animate-spin"})," Processing..."]}):ge.length>0?e.jsxs(e.Fragment,{children:[e.jsx(Oe,{className:"w-4 h-4"})," Add to Queue"]}):e.jsxs(e.Fragment,{children:[e.jsx(Ee,{className:"w-4 h-4"})," Generate ",N>1?`${N} Images`:"Image"]})})]})}),e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[ge.length>0&&e.jsxs(z,{className:"p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700",children:ge.length===1?"Current Task":`Queue (${ge.length})`}),ge.filter(n=>n.status==="pending"||n.status==="queued").length>0&&e.jsx("button",{onClick:async()=>{const n=ge.filter(j=>j.status==="pending"||j.status==="queued");for(const j of n)try{await S.request(`/api/tasks/${j.id}/cancel`,{method:"POST"})}catch{}a("Pending tasks cancelled","info"),U(),c()},className:"text-xs text-red-500 hover:text-red-700",children:"Cancel all pending"})]}),e.jsx("div",{className:"space-y-3",children:ge.map((n,j)=>e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[n.status==="processing"?e.jsx(he,{className:"w-4 h-4 animate-spin text-blue-500"}):n.status==="queued"?e.jsx(je,{className:"w-4 h-4 text-orange-500 animate-pulse"}):e.jsx(je,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-sm font-medium",children:n.status==="processing"?"Processing...":n.status==="queued"?`Queued${n.queue_position?` #${n.queue_position}`:""}`:n.status==="pending"?"Pending...":`#${j+1} ${n.status||"pending"}`})]}),e.jsx("button",{onClick:()=>le(n.id),className:"p-1 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded transition-colors",title:"Cancel task",children:e.jsx(ye,{className:"w-4 h-4"})})]}),e.jsx("p",{className:"text-xs text-gray-500 truncate mb-2",children:n.prompt?.slice(0,50)}),n.status==="processing"&&e.jsx("div",{className:"h-1.5 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-black transition-all",style:{width:`${n.progress||0}%`}})}),(n.status==="queued"||n.status==="pending")&&e.jsx("div",{className:"h-1.5 bg-orange-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-orange-500 animate-pulse",style:{width:"100%"}})})]},n.id))})]}),e.jsxs(z,{className:"p-5 min-h-[300px] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900",children:"Recent"}),ie.length>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:async()=>{const n=Date.now(),j=ie.filter(r=>r.status==="completed"&&!(r.completedAt&&n>r.completedAt+12*60*60*1e3));if(j.length===0){a("No completed images to download","info");return}try{a(`Preparing ${j.length} image${j.length!==1?"s":""}…`,"info");const r=(await ls(()=>import("./jszip.min-efe84dac.js").then(u=>u.j),["assets/jszip.min-efe84dac.js","assets/vendor-a6b94228.js"])).default,d=new r;let x=0;for(const u of j){const F=u.result||O[u.id],B=u.allImages||(F?[{data_uri:F,url:F}]:[]);if(B.length===0&&!F){try{const ee=await fetch(`${ve}/api/jobs/${u.id}/image`,{headers:S.token?{Authorization:`Bearer ${S.token}`}:{}});if(!ee.ok)continue;const re=await ee.blob();d.file(`image_${u.id}.png`,re),x++}catch{}continue}if(B.length>1)for(let ee=0;ee<B.length;ee++){const re=B[ee],i=re?.data_uri||re?.url||F;if(i)try{const w=await(await fetch(i)).blob();d.file(`image_${u.id}_${ee+1}.png`,w),x++}catch{}}else{const ee=F||B[0]?.data_uri||B[0]?.url;if(!ee)continue;try{const i=await(await fetch(ee)).blob();d.file(`image_${u.id}.png`,i),x++}catch{}}}if(x===0){a("Could not fetch any images","error");return}const R=await d.generateAsync({type:"blob"}),$=document.createElement("a");$.href=URL.createObjectURL(R),$.download=`images_recent_${Date.now()}.zip`,$.click(),URL.revokeObjectURL($.href),a(`Downloaded ${x} image${x!==1?"s":""}`,"success")}catch(r){a(r?.message||"Download failed","error")}},className:"text-xs font-medium text-gray-500 hover:text-gray-700 transition-colors flex items-center gap-1",children:[e.jsx(Pe,{className:"w-3.5 h-3.5"})," Download all"]}),e.jsx("button",{onClick:()=>{Object.values(T.current).forEach(n=>{try{URL.revokeObjectURL(n)}catch{}}),T.current={},y({}),K.current.clear(),Y([])},className:"text-xs font-medium text-red-500 hover:text-red-700 transition-colors",children:"Clear all"})]})]}),ie.length===0?e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-center py-8",children:[e.jsx("div",{className:"w-14 h-14 rounded-2xl bg-gray-100 flex items-center justify-center mb-4",children:e.jsx(Ee,{className:"w-7 h-7 text-gray-400"})}),e.jsx("p",{className:"text-sm font-medium text-gray-500 mb-1",children:"No completed images"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Generated images will appear here"})]}):e.jsx("div",{className:"space-y-3 overflow-y-auto max-h-[420px] pr-1 scrollbar-thin scrollbar-track-transparent scrollbar-thumb-gray-300 hover:scrollbar-thumb-gray-400",style:{scrollbarGutter:"stable"},children:ie.slice().reverse().map(n=>{const j=n.completedAt?n.completedAt+432e5:null,r=j&&Date.now()>j,d=j?cs(j):null,x=n.result||O[n.id];return e.jsxs("div",{className:`p-3.5 rounded-xl border transition-shadow hover:shadow-sm ${r?"bg-gray-50/80 border-gray-200":n.status==="completed"?"bg-emerald-50/80 border-emerald-200/60":"bg-red-50/80 border-red-200/60"}`,children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsxs("span",{className:`inline-flex items-center gap-1.5 px-2 py-0.5 rounded-full text-xs font-medium ${r?"bg-gray-200/60 text-gray-500":n.status==="completed"?"bg-emerald-200/60 text-emerald-700":n.status==="cancelled"?"bg-gray-200/60 text-gray-600":"bg-red-200/60 text-red-700"}`,children:[r?e.jsx(je,{className:"w-3 h-3"}):n.status==="completed"?e.jsx(Ce,{className:"w-3 h-3"}):e.jsx(Ie,{className:"w-3 h-3"}),r?"Expired":n.status==="completed"?"Ready":n.status==="cancelled"?"Cancelled":"Failed"]})}),x&&!r&&n.status==="completed"&&e.jsx("img",{src:x,alt:n.prompt,className:"w-full aspect-square object-cover rounded-xl border border-gray-200 mb-2 cursor-pointer hover:opacity-90 transition-opacity",onClick:()=>{x&&A({src:x,prompt:n.prompt,allImages:n.allImages||[{data_uri:x}],taskId:n.id})}}),e.jsx("p",{className:"text-xs text-gray-700 line-clamp-2 mb-2",children:n.prompt}),n.status==="completed"&&!r&&d&&e.jsxs("p",{className:"text-xs text-amber-600 flex items-center gap-1 mb-2",children:[e.jsx(je,{className:"w-3 h-3"})," ",d]}),n.error&&e.jsx("p",{className:"text-xs text-red-600 mb-2",children:n.error}),e.jsxs("div",{className:"flex gap-2",children:[n.status==="completed"&&!r?e.jsxs("button",{onClick:()=>Ne(n),className:"flex-1 flex items-center justify-center gap-1.5 px-2.5 py-2 bg-gray-900 text-white rounded-xl text-xs font-medium hover:bg-black transition-all",children:[e.jsx(Pe,{className:"w-3.5 h-3.5"})," Download"]}):r?e.jsx("span",{className:"text-xs text-gray-400 flex-1 text-center py-2",children:"Unavailable"}):null,e.jsx("button",{onClick:()=>{const R=T.current[n.id];if(R){try{URL.revokeObjectURL(R)}catch{}delete T.current[n.id],y($=>{const u={...$};return delete u[n.id],u})}K.current.delete(n.id),Y($=>I($.filter(u=>u.id!==n.id)))},className:"p-2 rounded-xl text-gray-400 hover:text-gray-600 hover:bg-gray-100 transition-colors",children:e.jsx(ye,{className:"w-4 h-4"})})]})]},n.id)})})]})]}),e.jsx(Ns,{open:!!h,onClose:()=>A(null),src:h?.src,prompt:h?.prompt,allImages:h?.allImages})]})}function Ks({showToast:l,user:c}){const[a,o]=t.useState([]),[g,m]=t.useState(!1),[p,D]=t.useState(""),[_,v]=t.useState(null),[b,N]=t.useState(!0),M=t.useCallback(async()=>{N(!0);try{const f=await S.request("/api/user/api-keys");o(f.api_keys||[])}catch(f){l(f.message,"error")}finally{N(!1)}},[l]);t.useEffect(()=>{M()},[M]);const W=async()=>{if(p.trim()){if(a.length>=5){l("Maximum 5 API keys allowed","error");return}try{const f=await S.request("/api/user/api-keys",{method:"POST",body:JSON.stringify({name:p.trim()})});v(f.api_key),M(),D(""),m(!1)}catch(f){l(f.message,"error")}}},C=async f=>{if(confirm("Delete this API key?"))try{await S.request(`/api/user/api-keys/${f}`,{method:"DELETE"}),o(a.filter(q=>q.id!==f)),l("API key deleted","success")}catch(q){l(q.message,"error")}};return e.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-black",children:"API Access"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["For programmatic access • ",a.length,"/5 keys used"]})]}),e.jsxs(J,{onClick:()=>m(!0),disabled:a.length>=5,className:"bg-black hover:bg-gray-800",children:[e.jsx(Oe,{className:"w-4 h-4"})," Create Key"]})]}),_&&e.jsx(z,{className:"p-4 bg-emerald-50 border-emerald-200",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ce,{className:"w-5 h-5 text-emerald-600 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-emerald-800",children:"API Key Created!"}),e.jsx("p",{className:"text-sm text-emerald-600 mt-1",children:"Copy it now — it won't be shown again."}),e.jsxs("div",{className:"flex items-center gap-2 mt-3",children:[e.jsx("code",{className:"flex-1 px-3 py-2 bg-white rounded-lg text-sm font-mono border border-emerald-200",children:_.api_key}),e.jsx(J,{size:"sm",onClick:()=>{navigator.clipboard.writeText(_.api_key),l("Copied!","success")},className:"bg-emerald-600 hover:bg-emerald-700",children:e.jsx(as,{className:"w-4 h-4"})})]})]}),e.jsx("button",{onClick:()=>v(null),children:e.jsx(ye,{className:"w-5 h-5 text-emerald-600"})})]})}),e.jsxs(z,{className:"overflow-hidden border-2 border-gray-200",children:[e.jsx("div",{className:"bg-gray-50 px-6 py-3 border-b border-gray-200",children:e.jsx("h3",{className:"font-semibold text-gray-900",children:"Your Keys"})}),b?e.jsx("div",{className:"p-8 flex justify-center",children:e.jsx(he,{className:"w-6 h-6 animate-spin text-gray-400"})}):a.length===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-gray-100 flex items-center justify-center mx-auto mb-4",children:e.jsx(Fe,{className:"w-8 h-8 text-gray-400"})}),e.jsx("p",{className:"text-gray-600 font-medium",children:"No API keys yet"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Create your first key to get started"})]}):e.jsx("div",{className:"divide-y divide-gray-100",children:a.map(f=>e.jsx("div",{className:"p-5 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-black flex items-center justify-center",children:e.jsx(Fe,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:f.name}),e.jsx("p",{className:"text-xs text-gray-500 font-mono",children:f.api_key})]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500 ml-13",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500"}),"Active"]}),e.jsxs("span",{children:[f.total_requests.toLocaleString()," requests"]}),e.jsxs("span",{children:["Limit: ",f.hourly_limit,"/hour"]})]})]}),e.jsx(J,{variant:"ghost",size:"sm",onClick:()=>C(f.id),className:"text-red-500 hover:text-red-700 hover:bg-red-50",children:e.jsx(We,{className:"w-4 h-4"})})]})},f.id))})]}),e.jsxs("div",{className:"border-2 border-gray-200 rounded-xl overflow-hidden bg-white",children:[e.jsxs("div",{className:"bg-black px-6 py-4 border-b-2 border-gray-200",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"API Documentation"}),e.jsx("p",{className:"text-gray-300 text-sm mt-1",children:"Complete API reference for voice synthesis"})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-lg mb-3",children:"Authentication"}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Base URL:"}),e.jsxs("code",{className:"block bg-white px-3 py-2 rounded-lg border border-gray-300 text-xs font-mono text-gray-800 mb-3",children:[window.location.origin,"/api/v1"]}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"All requests require authentication header:"}),e.jsx("code",{className:"block bg-white px-3 py-2 rounded-lg border border-gray-300 text-xs font-mono text-gray-800",children:"X-API-Key: your-api-key-here"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-lg mb-3",children:"API Endpoints"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-gray-50 px-4 py-3 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"px-2 py-1 bg-green-600 text-white text-xs font-bold rounded",children:"POST"}),e.jsx("code",{className:"text-sm font-mono font-semibold text-gray-900",children:"/synthesize"})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Create audio generation task"})]}),e.jsxs("div",{className:"p-4 bg-white",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Request Body:"}),e.jsx("pre",{className:"p-3 bg-gray-50 rounded border border-gray-200 overflow-x-auto text-xs leading-relaxed mb-3",children:`{
  "text": "Text to synthesize (required)",
  "voice_id": "21m00Tcm4TlvDq8ikWAM (required)",
  "model_id": "eleven_turbo_v2 (optional, default: eleven_multilingual_v2)",
  "voice_settings": {
    "stability": 0.5,
    "similarity_boost": 0.75,
    "style": 0.0,
    "use_speaker_boost": true
  },
  "speed": 1.0
}`}),e.jsx("p",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Response:"}),e.jsx("pre",{className:"p-3 bg-gray-50 rounded border border-gray-200 overflow-x-auto text-xs leading-relaxed",children:`{
  "ok": true,
  "task_id": "abc-123-xyz",
  "status": "processing" | "queued",
  "credits_charged": 1234,
  "message": "Task started"
}`})]})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-gray-50 px-4 py-3 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"px-2 py-1 bg-blue-600 text-white text-xs font-bold rounded",children:"GET"}),e.jsxs("code",{className:"text-sm font-mono font-semibold text-gray-900",children:["/status/","{task_id}"]})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Check task status and progress"})]}),e.jsxs("div",{className:"p-4 bg-white",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Response:"}),e.jsx("pre",{className:"p-3 bg-gray-50 rounded border border-gray-200 overflow-x-auto text-xs leading-relaxed",children:`{
  "status": "queued" | "processing" | "completed" | "failed",
  "progress": 0-100,
  "queue_position": 1,
  "audio_url": "https://...",
  "error": "error message if failed"
}`})]})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-gray-50 px-4 py-3 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"px-2 py-1 bg-blue-600 text-white text-xs font-bold rounded",children:"GET"}),e.jsxs("code",{className:"text-sm font-mono font-semibold text-gray-900",children:["/download/","{task_id}","?format=redirect|json"]})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Download audio file or get JSON with metadata"})]}),e.jsxs("div",{className:"p-4 bg-white",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Query Parameters:"}),e.jsxs("ul",{className:"text-xs text-gray-600 space-y-1 mb-3 ml-4",children:[e.jsx("li",{children:"• format=redirect (default) - Redirect to audio URL"}),e.jsx("li",{children:"• format=json - Return JSON with URL and metadata"})]}),e.jsx("p",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Response (format=json):"}),e.jsx("pre",{className:"p-3 bg-gray-50 rounded border border-gray-200 overflow-x-auto text-xs leading-relaxed",children:`{
  "ok": true,
  "task_id": "abc-123",
  "status": "completed",
  "audio_url": "https://...",
  "char_count": 1234,
  "credits_charged": 1234,
  "model": "eleven_turbo_v2",
  "created_at": 1234567890,
  "completed_at": 1234567900,
  "voice_id": "21m00Tcm4TlvDq8ikWAM",
  "duration_ms": 5000
}`})]})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-gray-50 px-4 py-3 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"px-2 py-1 bg-red-600 text-white text-xs font-bold rounded",children:"DELETE"}),e.jsxs("code",{className:"text-sm font-mono font-semibold text-gray-900",children:["/tasks/","{task_id}"]})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Cancel task and refund credits"})]}),e.jsxs("div",{className:"p-4 bg-white",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Response:"}),e.jsx("pre",{className:"p-3 bg-gray-50 rounded border border-gray-200 overflow-x-auto text-xs leading-relaxed",children:`{
  "ok": true,
  "message": "Task cancelled successfully",
  "credits_refunded": 1234
}`})]})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-gray-50 px-4 py-3 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"px-2 py-1 bg-blue-600 text-white text-xs font-bold rounded",children:"GET"}),e.jsx("code",{className:"text-sm font-mono font-semibold text-gray-900",children:"/tasks?status=completed&limit=20"})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"List your tasks with optional filters"})]}),e.jsxs("div",{className:"p-4 bg-white",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Query Parameters:"}),e.jsxs("ul",{className:"text-xs text-gray-600 space-y-1 mb-3 ml-4",children:[e.jsx("li",{children:"• status: Filter by status (processing, queued, completed, failed)"}),e.jsx("li",{children:"• limit: Max results (default 20, max 100)"})]}),e.jsx("p",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Response:"}),e.jsx("pre",{className:"p-3 bg-gray-50 rounded border border-gray-200 overflow-x-auto text-xs leading-relaxed",children:`{
  "ok": true,
  "tasks": [
    {
      "id": "task-id",
      "status": "completed",
      "created_at": 1234567890,
      "credits_charged": 1234,
      "char_count": 1234,
      "model": "eleven_turbo_v2"
    }
  ]
}`})]})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-gray-50 px-4 py-3 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"px-2 py-1 bg-blue-600 text-white text-xs font-bold rounded",children:"GET"}),e.jsx("code",{className:"text-sm font-mono font-semibold text-gray-900",children:"/balance"})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Get credit balance and packages"})]}),e.jsxs("div",{className:"p-4 bg-white",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Response:"}),e.jsx("pre",{className:"p-3 bg-gray-50 rounded border border-gray-200 overflow-x-auto text-xs leading-relaxed",children:`{
  "ok": true,
  "total_credits": 5000000,
  "concurrent_slots": ${c?.concurrent_slots||1},
  "packages": [
    {
      "id": "pkg-id",
      "credits": 1000000,
      "expires_at": 1234567890,
      "days_remaining": 25
    }
  ]
}`})]})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-gray-50 px-4 py-3 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"px-2 py-1 bg-blue-600 text-white text-xs font-bold rounded",children:"GET"}),e.jsx("code",{className:"text-sm font-mono font-semibold text-gray-900",children:"/voices?page=1&limit=20"})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Get list of available voices"})]}),e.jsxs("div",{className:"p-4 bg-white",children:[e.jsx("p",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Response:"}),e.jsx("pre",{className:"p-3 bg-gray-50 rounded border border-gray-200 overflow-x-auto text-xs leading-relaxed",children:`{
  "ok": true,
  "voices": [
    {
      "voice_id": "21m00Tcm4TlvDq8ikWAM",
      "name": "Rachel",
      "category": "premade"
    }
  ],
  "has_more": true
}`})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-lg mb-3",children:"Voice Settings Parameters"}),e.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left font-semibold",children:"Parameter"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold",children:"Range"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold",children:"Default"}),e.jsx("th",{className:"px-4 py-3 text-left font-semibold",children:"Description"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-100",children:[e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-3 font-mono text-xs",children:"stability"}),e.jsx("td",{className:"px-4 py-3 text-gray-600",children:"0.0 - 1.0"}),e.jsx("td",{className:"px-4 py-3 text-gray-600",children:"0.5"}),e.jsx("td",{className:"px-4 py-3 text-gray-600",children:"Higher values make output more consistent"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-3 font-mono text-xs",children:"similarity_boost"}),e.jsx("td",{className:"px-4 py-3 text-gray-600",children:"0.0 - 1.0"}),e.jsx("td",{className:"px-4 py-3 text-gray-600",children:"0.75"}),e.jsx("td",{className:"px-4 py-3 text-gray-600",children:"Higher values boost voice similarity"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-3 font-mono text-xs",children:"style"}),e.jsx("td",{className:"px-4 py-3 text-gray-600",children:"0.0 - 1.0"}),e.jsx("td",{className:"px-4 py-3 text-gray-600",children:"0.0"}),e.jsx("td",{className:"px-4 py-3 text-gray-600",children:"Style exaggeration amount"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-3 font-mono text-xs",children:"use_speaker_boost"}),e.jsx("td",{className:"px-4 py-3 text-gray-600",children:"boolean"}),e.jsx("td",{className:"px-4 py-3 text-gray-600",children:"true"}),e.jsx("td",{className:"px-4 py-3 text-gray-600",children:"Boost speaker clarity"})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-3 font-mono text-xs",children:"speed"}),e.jsx("td",{className:"px-4 py-3 text-gray-600",children:"0.25 - 4.0"}),e.jsx("td",{className:"px-4 py-3 text-gray-600",children:"1.0"}),e.jsx("td",{className:"px-4 py-3 text-gray-600",children:"Playback speed multiplier"})]})]})]})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-lg mb-3",children:"Available Models"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsx("code",{className:"text-sm font-semibold text-gray-900",children:"eleven_turbo_v2"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Fastest model, good quality"})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsx("code",{className:"text-sm font-semibold text-gray-900",children:"eleven_turbo_v2_5"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Enhanced turbo version"})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsx("code",{className:"text-sm font-semibold text-gray-900",children:"eleven_multilingual_v2"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Supports multiple languages"})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsx("code",{className:"text-sm font-semibold text-gray-900",children:"eleven_monolingual_v1"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"English only, high quality"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-lg mb-3",children:"Quick Start Examples"}),e.jsx("div",{className:"bg-black rounded-lg p-5 border-2 border-gray-800",children:e.jsx("pre",{className:"text-xs text-gray-300 font-mono leading-relaxed overflow-x-auto",children:`# 1. Create task
curl -X POST ${window.location.origin}/api/v1/synthesize \\
  -H "X-API-Key: your-key-here" \\
  -H "Content-Type: application/json" \\
  -d '{
    "text": "Hello world",
    "voice_id": "21m00Tcm4TlvDq8ikWAM",
    "model_id": "eleven_turbo_v2",
    "voice_settings": {
      "stability": 0.5,
      "similarity_boost": 0.75
    }
  }'

# Response: {"task_id": "abc-123", "status": "processing"}

# 2. Check status
curl ${window.location.origin}/api/v1/status/abc-123 \\
  -H "X-API-Key: your-key-here"

# 3. Check balance
curl ${window.location.origin}/api/v1/balance \\
  -H "X-API-Key: your-key-here"

# 4. List tasks
curl ${window.location.origin}/api/v1/tasks?status=completed \\
  -H "X-API-Key: your-key-here"

# 5. Download audio (redirect)
curl ${window.location.origin}/api/v1/download/abc-123 \\
  -H "X-API-Key: your-key-here" -o audio.mp3

# 6. Get audio metadata (JSON)
curl ${window.location.origin}/api/v1/download/abc-123?format=json \\
  -H "X-API-Key: your-key-here"

# 7. Cancel task
curl -X DELETE ${window.location.origin}/api/v1/tasks/abc-123 \\
  -H "X-API-Key: your-key-here"`})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsx("p",{className:"font-bold text-gray-900 mb-3",children:"Features"}),e.jsxs("ul",{className:"text-sm text-gray-700 space-y-2",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-600 font-bold",children:"✓"}),e.jsx("span",{children:"Same credit system as web interface"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-600 font-bold",children:"✓"}),e.jsx("span",{children:"Automatic task queueing (FIFO)"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-600 font-bold",children:"✓"}),e.jsx("span",{children:"Credit refunds on cancellation"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-600 font-bold",children:"✓"}),e.jsx("span",{children:"Real-time progress tracking"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-600 font-bold",children:"✓"}),e.jsx("span",{children:"All voice models supported"})]})]})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsx("p",{className:"font-bold text-gray-900 mb-3",children:"Rate Limits"}),e.jsxs("ul",{className:"text-sm text-gray-700 space-y-2",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-gray-400",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{children:"100"})," requests per hour per key"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-gray-400",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{children:c?.concurrent_slots||1})," concurrent task",(c?.concurrent_slots||1)>1?"s":""," (your current limit)"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-gray-400",children:"•"}),e.jsxs("span",{children:["Max ",e.jsx("strong",{children:"100"})," tasks per list call"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-gray-400",children:"•"}),e.jsxs("span",{children:[e.jsx("strong",{children:"12 hours"})," task expiration"]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-gray-400",children:"•"}),e.jsxs("span",{children:["Max ",e.jsx("strong",{children:"5"})," API keys per account"]})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-lg mb-3",children:"HTTP Status Codes"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"border-2 border-red-200 rounded-lg p-3 bg-white",children:[e.jsx("code",{className:"text-lg font-bold text-red-600",children:"401"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Invalid or missing API key"})]}),e.jsxs("div",{className:"border-2 border-red-200 rounded-lg p-3 bg-white",children:[e.jsx("code",{className:"text-lg font-bold text-red-600",children:"402"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Insufficient credits"})]}),e.jsxs("div",{className:"border-2 border-red-200 rounded-lg p-3 bg-white",children:[e.jsx("code",{className:"text-lg font-bold text-red-600",children:"429"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Rate limit exceeded"})]}),e.jsxs("div",{className:"border-2 border-red-200 rounded-lg p-3 bg-white",children:[e.jsx("code",{className:"text-lg font-bold text-red-600",children:"503"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Service unavailable"})]})]})]})]})]}),e.jsx($e,{open:g,onClose:()=>m(!1),title:"Create API Key",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(ke,{label:"Name",placeholder:"My API Key",value:p,onChange:f=>D(f.target.value)}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(J,{variant:"secondary",onClick:()=>m(!1),children:"Cancel"}),e.jsx(J,{onClick:W,disabled:!p.trim(),children:"Create"})]})]})})]})}function Xs({showToast:l,user:c}){const[a,o]=t.useState(1e6),[g,m]=t.useState(30),[p,D]=t.useState(!1),_=[{credits:1e6,price:5,savings:60},{credits:3e6,price:12,savings:68},{credits:5e6,price:18,savings:71},{credits:1e7,price:32,savings:74.4},{credits:15e6,price:45,savings:76},{credits:3e7,price:84,savings:77.6}],v=[{days:30,label:"1 Month",priceMultiplier:1},{days:60,label:"2 Months",priceMultiplier:1.15},{days:90,label:"3 Months",priceMultiplier:1.3}],b=f=>f===-1?null:{ttsMinutes:Math.round(f/1e3)},N=_.find(f=>f.credits===a)||_[0],M=v.find(f=>f.days===g)?.priceMultiplier||1,W=N.price*M,C=b(a);return p?e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsx(he,{className:"w-6 h-6 animate-spin text-gray-300"})}):e.jsx("div",{className:"max-w-7xl mx-auto px-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(z,{className:"p-6 bg-white",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(Ve,{className:"w-5 h-5 text-gray-900"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Paid tier"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-900 mb-3",children:"Select Credits Amount"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:_.map(f=>e.jsxs("button",{onClick:()=>o(f.credits),className:`p-3 rounded-lg border-2 text-left transition-all ${a===f.credits?"border-gray-900 bg-gray-50":"border-gray-300 bg-white hover:border-gray-900"}`,children:[e.jsxs("div",{className:"font-bold text-gray-900",children:[(f.credits/1e6).toFixed(f.credits<1e6?1:0),"M"]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["$",f.price.toFixed(2)]}),f.savings>0&&e.jsxs("div",{className:"text-xs text-emerald-600 font-medium mt-1",children:["Save ",f.savings,"%"]})]},f.credits))})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-900 mb-3",children:"Select validity period"}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:v.map(f=>e.jsx("button",{onClick:()=>m(f.days),className:`px-4 py-3 rounded-lg border-2 font-semibold text-sm transition-all ${g===f.days?"border-gray-900 bg-gray-900 text-white":"border-gray-300 bg-white text-gray-700 hover:border-gray-900"}`,children:f.label},f.days))})]}),e.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Credits:"}),e.jsx("span",{className:"font-bold text-gray-900",children:a.toLocaleString()})]}),e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Duration:"}),e.jsxs("span",{className:"font-medium text-gray-900",children:[g," days"]})]}),C&&C.ttsMinutes>0&&e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"TTS Time:"}),e.jsxs("span",{className:"font-medium text-gray-900",children:["≈ ",C.ttsMinutes.toLocaleString()," min"]})]}),N.savings>0&&e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-gray-200",children:[e.jsx("span",{className:"text-sm text-emerald-600 font-medium",children:"Savings:"}),e.jsxs("span",{className:"font-bold text-emerald-600",children:[N.savings,"%"]})]})]}),e.jsxs("div",{className:"mb-6 text-center",children:[e.jsxs("div",{className:"text-4xl font-bold text-gray-900 mb-1",children:["$",W.toFixed(2)]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Total price"})]}),e.jsx("div",{children:e.jsx("button",{onClick:()=>l("Payment integration coming soon","info"),className:"w-full py-3.5 rounded-lg font-semibold text-base bg-black hover:bg-gray-900 text-white transition-colors shadow-lg",children:"Proceed to Payment"})})]}),e.jsxs(z,{className:"p-6 bg-white",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(Ve,{className:"w-5 h-5 text-gray-900"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Your Credits"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Total Available"}),e.jsx("div",{className:"text-3xl font-bold text-gray-900",children:(c?.credit_packages?.reduce((f,q)=>f+q.credits_remaining,0)||0).toLocaleString()}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"credits"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Credit packages"}),c?.credit_packages&&c.credit_packages.length>0?e.jsx("div",{className:"space-y-2",children:c.credit_packages.map(f=>{const q=new Date(f.expires_at_ms),V=Math.ceil((f.expires_at_ms-Date.now())/(24*60*60*1e3));return e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsxs("div",{className:"text-sm font-semibold text-gray-900",children:[f.credits_remaining.toLocaleString()," credits"]}),e.jsxs("div",{className:`text-xs px-2 py-0.5 rounded-full ${V<=7?"bg-red-100 text-red-700":"bg-gray-100 text-gray-600"}`,children:[V,"d left"]})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Expires: ",q.toLocaleDateString()]}),e.jsxs("div",{className:"mt-1 text-xs text-gray-400",children:["Used: ",(f.credits_initial-f.credits_remaining).toLocaleString()," / ",f.credits_initial.toLocaleString()]})]},f.id)})}):e.jsx("div",{className:"text-sm text-gray-500 py-4 text-center",children:"No active credit packages"})]})]})]})})}function Ys({onLogin:l,showToast:c}){const[a,o]=t.useState(""),[g,m]=t.useState(!1),p=async D=>{if(D.preventDefault(),!a.trim()){c("Please enter admin token","warning");return}m(!0);try{if(!(await fetch(`${ve}/api/admin/stats`,{headers:{"X-Admin-Token":a.trim()}})).ok)throw new Error("Invalid admin token");S.setAdminToken(a.trim()),l(),c("Welcome to Admin Panel","success")}catch(_){c(_.message,"error")}finally{m(!1)}};return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:e.jsxs(z,{className:"w-full max-w-md p-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[e.jsx("div",{className:"w-12 h-12 bg-black rounded-xl flex items-center justify-center",children:e.jsx(us,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold",children:"Admin Panel"}),e.jsx("p",{className:"text-sm text-gray-500",children:"FiftyFive Labs"})]})]}),e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Admin Token"}),e.jsx("input",{type:"password",placeholder:"Enter admin token",value:a,onChange:D=>o(D.target.value),className:"w-full px-3 py-2.5 border border-gray-200 rounded-lg bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-black/5",required:!0})]}),e.jsxs(J,{type:"submit",loading:g,className:"w-full",size:"lg",children:[e.jsx(Is,{className:"w-4 h-4"})," Access Admin Panel"]})]}),e.jsx("div",{className:"mt-6 pt-6 border-t border-gray-100 text-center",children:e.jsx("a",{href:"/",className:"text-sm text-gray-500 hover:text-gray-700",children:"← Back to main app"})})]})})}function Qs({showToast:l,onLogout:c}){const[a,o]=t.useState("stats"),[g,m]=t.useState(null),[p,D]=t.useState(null),[_,v]=t.useState([]),[b,N]=t.useState(!1),[M,W]=t.useState([]),[C,f]=t.useState("tasks"),[q,V]=t.useState([]),[H,ae]=t.useState([]),[te,ie]=t.useState([]),[Y,K]=t.useState(1),[ce,xe]=t.useState(0),[de,h]=t.useState(""),[A,O]=t.useState(!1),[y,T]=t.useState({name:"",api_key:"",provider:"voicer",hourly_limit:2e3,concurrent_limit:10}),[I,X]=t.useState(null),[Q,U]=t.useState(!1),[Z,oe]=t.useState({credits:15e6,duration_days:30}),[le,pe]=t.useState(null),[be,Ne]=t.useState([]);t.useState(!1),t.useState(null),t.useState({id:"",title:"",subtitle:"",price_usd:0,credits:1e4,duration_days:30,description:"",features:[""],popular:!1,is_active:!0,sort_order:0});const[ge,n]=t.useState([]),[j,r]=t.useState(null);t.useEffect(()=>{a==="stats"&&S.request("/api/admin/stats",{admin:!0}).then(s=>m(s.stats)).catch(s=>l(s.message,"error"))},[a,l]),t.useEffect(()=>{if(a!=="stats"&&a!=="tasks")return;const s=async()=>{try{const ue=await S.request("/api/admin/realtime-stats",{admin:!0});D(ue)}catch{}try{N(!0);const me=(await S.request("/api/admin/active-tasks",{admin:!0})).tasks||[];v(we=>we.length===0?me:me.map(fe=>{const Ae=we.find(_e=>_e.id===fe.id);return Ae&&Ae.status==="processing"&&fe.status==="processing"?{...fe,progress:Math.max(Ae.progress||0,fe.progress||0)}:fe})),N(!1);const Ue=me.filter(we=>we.status==="processing");if(Ue.length>0){const we=fe=>(fe.type==="image"?"/api/image/status/":"/api/voice/status/")+fe.id;Promise.allSettled(Ue.map(async fe=>{try{const Ae=await S.request(we(fe));return{id:fe.id,progress:Ae.progress||0,success:!0}}catch{return{id:fe.id,progress:fe.progress||0,success:!1}}})).then(fe=>{v(Ae=>Ae.map(_e=>{if(_e.status!=="processing")return _e;const Qe=fe.find(Le=>Le.status==="fulfilled"&&Le.value.id===_e.id&&Le.value.success);if(Qe&&Qe.value){const Le=Qe.value.progress,Ss=_e.progress||0;return{..._e,progress:Math.max(Le,Ss)}}return _e}))})}}catch{}};s();const E=_.filter(ue=>ue.status==="processing").length>0?2e3:_.length>0?5e3:15e3,se=setInterval(s,E);return()=>clearInterval(se)},[a,_.length,_.filter(s=>s.status==="processing").length]);const d=t.useCallback(async()=>{try{const s=await S.request(`/api/admin/users?page=${Y}&limit=20${de?`&search=${de}`:""}`,{admin:!0}),L=await Promise.all((s.users||[]).map(async E=>{try{const se=await S.request(`/api/admin/users/${E.id}/packages`,{admin:!0});return{...E,credit_packages:se.packages||[]}}catch{return{...E,credit_packages:[]}}}));ae(L),xe(s.total||0)}catch(s){l(s.message,"error")}},[Y,de,l]);t.useEffect(()=>{a==="users"&&d()},[a,d]);const x=t.useCallback(async()=>{try{const L=((await S.request("/api/admin/task-log?limit=200",{admin:!0})).tasks||[]).filter(E=>E.type==="task");W(L)}catch(s){l(s.message,"error")}},[l]),R=t.useCallback(async()=>{try{const s=new URLSearchParams;s.set("limit","200"),C==="user_logs"&&s.set("scope","user"),C==="system_logs"&&s.set("scope","system"),C==="referrals"&&s.set("event_type","referral_signup,referral_bonus");const L=await S.request(`/api/admin/logs?${s.toString()}`,{admin:!0});V(L.logs||[])}catch(s){l(s.message,"error")}},[C,l]);t.useEffect(()=>{a==="log"&&(C==="tasks"?x():R())},[a,C,x,R]);const $=t.useCallback(async()=>{try{const s=await S.request("/api/admin/api-keys",{admin:!0});ie(s.api_keys||[])}catch(s){l(s.message,"error")}},[l]);t.useEffect(()=>{a==="keys"&&$()},[a,$]);const u=t.useCallback(async()=>{try{const s=await S.request("/api/admin/model-pricing",{admin:!0});n(s.pricing||[])}catch(s){l(s.message,"error")}},[l]);t.useEffect(()=>{a==="pricing"&&u()},[a,u]);const F=async(s,L)=>{try{await S.request(`/api/admin/model-pricing/${s}`,{admin:!0,method:"PATCH",body:JSON.stringify({credits_per_image:L})}),l("Pricing updated","success"),u()}catch(E){l(E.message,"error")}},B=async()=>{try{const s={...y,provider:y.provider||"voicer"},L=await S.request("/api/admin/api-keys",{admin:!0,method:"POST",body:JSON.stringify(s)});l("API key created","success"),O(!1),T({name:"",api_key:"",provider:"voicer",hourly_limit:2e3,concurrent_limit:10}),$()}catch(s){l(s.message,"error")}},ee=async(s,L)=>{try{await S.request(`/api/admin/api-keys/${s}`,{admin:!0,method:"PATCH",body:JSON.stringify(L)}),l("Updated","success"),$()}catch(E){l(E.message,"error")}},re=async s=>{if(confirm("Delete this API key?"))try{await S.request(`/api/admin/api-keys/${s}`,{admin:!0,method:"DELETE"}),l("Deleted","success"),$()}catch(L){l(L.message,"error")}},i=async()=>{if(I)try{await S.request(`/api/admin/users/${I.id}`,{admin:!0,method:"PATCH",body:JSON.stringify({credits_balance:I.credits_balance,concurrent_slots:I.concurrent_slots,image_concurrent_slots:I.image_concurrent_slots,is_active:I.is_active})}),l("User updated","success"),X(null),d()}catch(s){l(s.message,"error")}},k=async()=>{try{const s=parseInt(Z.credits),L=parseInt(Z.duration_days);if(s<1e6||s>3e7){l("Credits must be between 1M and 30M","error");return}if(![30,60,90].includes(L)){l("Duration must be 30, 60, or 90 days","error");return}await S.request(`/api/admin/users/${I.id}/packages`,{method:"POST",admin:!0,body:JSON.stringify({credits:s,duration_days:L,source:"admin"})}),l("Package added successfully","success"),U(!1),oe({credits:15e6,duration_days:30});const E=await S.request(`/api/admin/users/${I.id}/packages`,{admin:!0});X({...I,credit_packages:E.packages||[]})}catch(s){l(s.message,"error")}},w=async()=>{try{const s=parseInt(Z.credits),L=parseInt(Z.duration_days);if(s<0||s>le.credits_initial){l("Invalid credits amount","error");return}if(![30,60,90].includes(L)){l("Duration must be 30, 60, or 90 days","error");return}await S.request(`/api/admin/users/${I.id}/packages/${le.id}`,{method:"PATCH",admin:!0,body:JSON.stringify({credits_remaining:s,duration_days:L})}),l("Package updated successfully","success"),pe(null);const E=await S.request(`/api/admin/users/${I.id}/packages`,{admin:!0});X({...I,credit_packages:E.packages||[]})}catch(s){l(s.message,"error")}},P=async s=>{try{await S.request(`/api/admin/users/${I.id}/packages/${s}`,{method:"DELETE",admin:!0}),l("Package deleted","success");const L=await S.request(`/api/admin/users/${I.id}/packages`,{admin:!0});X({...I,credit_packages:L.packages||[]})}catch(L){l(L.message,"error")}},G=t.useCallback(async()=>{try{const s=await S.request("/api/admin/plans",{admin:!0});Ne(s.plans||[])}catch(s){l(s.message,"error")}},[l]);t.useEffect(()=>{I&&be.length===0&&G()},[I,be.length,G]);const ne=()=>{S.setAdminToken(null),c()};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white border-b border-gray-100 sticky top-0 z-20",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 bg-black rounded-xl flex items-center justify-center",children:e.jsx(us,{className:"w-5 h-5 text-white"})}),e.jsx("span",{className:"text-lg font-semibold",children:"Admin Panel"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("a",{href:"/",className:"text-sm text-gray-500 hover:text-gray-700",children:"← Main App"}),e.jsxs(J,{variant:"ghost",size:"sm",onClick:ne,children:[e.jsx(hs,{className:"w-4 h-4"})," Logout"]})]})]})})}),e.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("div",{className:"flex gap-2 mb-6 overflow-x-auto pb-2",children:[{id:"stats",label:"Dashboard",icon:ds},{id:"tasks",label:"Active Tasks",icon:ze},{id:"log",label:"Task Log",icon:Re},{id:"users",label:"Users",icon:es},{id:"keys",label:"API Keys",icon:Fe},{id:"pricing",label:"Model Pricing",icon:ps}].map(s=>e.jsxs("button",{onClick:()=>o(s.id),onMouseEnter:async()=>{if(s.id==="tasks"&&a!=="tasks")try{const L=await S.request("/api/admin/active-tasks",{admin:!0});v(L.tasks||[])}catch{}},className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium whitespace-nowrap transition-all ${a===s.id?"bg-black text-white":"bg-white border border-gray-200 text-gray-600 hover:bg-gray-50"}`,children:[e.jsx(s.icon,{className:"w-4 h-4"}),s.label]},s.id))}),a==="stats"&&g&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[{label:"Total Users",value:g.users?.total,icon:es,color:"bg-blue-100 text-blue-600"},{label:"Active 24h",value:g.users?.active_24h,icon:ze,color:"bg-emerald-100 text-emerald-600"},{label:"Total Jobs",value:g.jobs?.total,icon:ds,color:"bg-purple-100 text-purple-600"},{label:"Jobs 24h",value:g.jobs?.last_24h,icon:Ve,color:"bg-amber-100 text-amber-600"}].map((s,L)=>e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center ${s.color}`,children:e.jsx(s.icon,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:s.value?.toLocaleString()||0}),e.jsx("p",{className:"text-xs text-gray-500",children:s.label})]})]})},L))}),e.jsxs("div",{className:"grid sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(z,{className:"p-4 bg-gradient-to-br from-violet-50 to-purple-50 border-purple-100",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center bg-purple-500 text-white",children:e.jsx(De,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-purple-900",children:(g.jobs?.characters_today||0).toLocaleString()}),e.jsx("p",{className:"text-xs text-purple-600",children:"Characters Today"})]})]})}),e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center bg-cyan-100 text-cyan-600",children:e.jsx(De,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:(g.jobs?.total_characters||0).toLocaleString()}),e.jsx("p",{className:"text-xs text-gray-500",children:"Total Characters"})]})]})}),e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center bg-green-100 text-green-600",children:e.jsx(Ce,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:g.jobs?.completed?.toLocaleString()||0}),e.jsx("p",{className:"text-xs text-gray-500",children:"Completed"})]})]})}),e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center bg-rose-100 text-rose-600",children:e.jsx(Ie,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:g.jobs?.failed?.toLocaleString()||0}),e.jsx("p",{className:"text-xs text-gray-500",children:"Failed Tasks"})]})]})})]}),e.jsx(_s,{stats:{...g,__mode:"admin"}}),p&&e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ze,{className:"w-5 h-5 text-emerald-500"}),e.jsxs("span",{className:"font-medium",children:["Active Tasks: ",p.voicer_total_concurrent||0]})]}),e.jsx("button",{onClick:()=>o("tasks"),onMouseEnter:async()=>{if(a!=="tasks")try{const s=await S.request("/api/admin/active-tasks",{admin:!0});v(s.tasks||[])}catch{}},className:"text-sm text-blue-500 hover:text-blue-700 transition-colors",children:"View Details →"})]})})]}),a==="tasks"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h3",{className:"font-medium",children:"Active Tasks"}),e.jsxs("span",{className:"px-2 py-0.5 bg-emerald-100 text-emerald-700 text-sm rounded-full font-medium",children:[_.length," active"]}),p&&e.jsxs("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 text-sm rounded-full font-medium",children:[p.voicer_total_concurrent||0," slots"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[p&&p.voicer_total_concurrent>0&&_.length===0&&e.jsx("span",{className:"text-xs text-amber-600 bg-amber-50 px-2 py-1 rounded",children:"⚠️ Slots stuck!"}),e.jsxs(J,{variant:"secondary",size:"sm",onClick:async()=>{try{const s=await S.request("/api/admin/sync-concurrent",{admin:!0,method:"POST"});l(`Synced: ${s.processing_jobs} jobs`,"success")}catch(s){l(s.message,"error")}},children:[e.jsx(Ge,{className:"w-3 h-3"})," Sync"]}),e.jsxs(J,{variant:"ghost",size:"sm",className:"text-red-500 hover:bg-red-50",onClick:async()=>{if(confirm("Reset all concurrent slots? This will clear ALL slot counters."))try{await S.request("/api/admin/reset-concurrent",{admin:!0,method:"POST"}),l("All slots reset","success")}catch(s){l(s.message,"error")}},children:[e.jsx(ye,{className:"w-3 h-3"})," Reset Slots"]})]})]}),b&&_.length===0?e.jsxs(z,{className:"p-8 text-center",children:[e.jsx(he,{className:"w-12 h-12 text-blue-500 mx-auto mb-3 animate-spin"}),e.jsx("p",{className:"text-gray-500",children:"Loading tasks..."})]}):_.length===0?e.jsxs(z,{className:"p-8 text-center",children:[e.jsx(ze,{className:"w-12 h-12 text-gray-200 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"No active tasks"})]}):e.jsx("div",{className:"space-y-3",children:_.map(s=>e.jsx(z,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(he,{className:"w-4 h-4 animate-spin text-blue-500"}),e.jsx("span",{className:"font-medium text-sm",children:s.nickname||"Unknown"}),s.email&&e.jsx("span",{className:"text-xs text-gray-400",children:s.email})]}),e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2 mb-2",children:s.prompt}),e.jsxs("div",{className:"flex flex-wrap gap-2 text-xs mb-2",children:[e.jsx("span",{className:"px-2 py-0.5 bg-gray-100 rounded",children:s.model}),e.jsxs("span",{className:"px-2 py-0.5 bg-gray-100 rounded",children:[s.credits_charged?.toLocaleString()," credits"]}),s.api_key_name&&e.jsx("span",{className:"px-2 py-0.5 bg-blue-50 text-blue-600 rounded",children:s.api_key_name})]}),(s.status==="processing"||s.status==="pending")&&e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-1",children:[e.jsx("span",{children:s.status==="processing"?"Processing":"Pending"}),e.jsxs("span",{children:[s.progress||0,"%"]})]}),e.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500 transition-all duration-300",style:{width:`${s.progress||0}%`}})})]}),s.status==="queued"&&e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-1",children:[e.jsx("span",{children:"In queue"}),e.jsxs("span",{children:["Position: ",s.queue_position||"?"]})]}),e.jsx("div",{className:"h-2 bg-purple-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-purple-500 animate-pulse",style:{width:"100%"}})})]}),e.jsxs("p",{className:"text-xs text-gray-400",children:["Started ",new Date(s.created_at_ms).toLocaleString()]})]}),e.jsxs(J,{size:"sm",variant:"ghost",className:"text-red-500 hover:bg-red-50",onClick:async()=>{if(confirm("Cancel this task and refund credits?"))try{await S.request(`/api/admin/tasks/${s.id}/cancel`,{admin:!0,method:"POST"}),l("Task cancelled","success")}catch(L){l(L.message,"error")}},children:[e.jsx(ye,{className:"w-4 h-4"})," Cancel"]})]})},s.id))}),p&&p.api_keys?.length>0&&e.jsxs(z,{className:"p-4",children:[e.jsx("h4",{className:"font-medium text-sm mb-3",children:"API Key Slots"}),e.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-3",children:p.api_keys.map(s=>e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-medium text-sm",children:s.name}),e.jsxs("span",{className:`text-sm font-medium ${s.current_concurrent>0?"text-emerald-600":"text-gray-400"}`,children:[s.current_concurrent,"/",s.concurrent_limit]})]}),e.jsx("div",{className:"w-full h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full transition-all ${s.current_concurrent>0?"bg-emerald-500":"bg-gray-300"}`,style:{width:`${Math.min(100,s.current_concurrent/s.concurrent_limit*100)}%`}})})]},s.key_id))})]}),p&&p.users?.length>0&&e.jsxs(z,{className:"p-4",children:[e.jsxs("h4",{className:"font-medium text-sm mb-3",children:["Active Users (",p.users.length,")"]}),e.jsx("div",{className:"space-y-2",children:p.users.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[e.jsx("span",{className:"font-medium text-sm",children:s.nickname}),e.jsxs("span",{className:"text-sm text-gray-500",children:[s.current_concurrent,"/",s.concurrent_limit," tasks"]})]},s.user_id))})]})]}),a==="log"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Activity Log"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Recent activity (tasks & events)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex gap-1 p-1 bg-gray-100 rounded-lg",children:[{id:"tasks",label:"Tasks & events"},{id:"user_logs",label:"User logs"},{id:"system_logs",label:"System logs"},{id:"referrals",label:"Referrals"}].map(s=>e.jsx("button",{onClick:()=>f(s.id),className:`px-3 py-1.5 text-xs font-medium rounded-md transition-all ${C===s.id?"bg-white text-gray-900 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:s.label},s.id))}),e.jsx(J,{variant:"secondary",size:"sm",onClick:C==="tasks"?x:R,children:e.jsx(Ge,{className:"w-4 h-4"})})]})]}),C==="tasks"?M.length===0?e.jsxs(z,{className:"p-8 text-center",children:[e.jsx(Re,{className:"w-12 h-12 text-gray-200 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"No activity yet"})]}):e.jsxs(z,{className:"overflow-hidden",children:[e.jsx("div",{className:"max-h-[600px] overflow-y-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"sticky top-0 bg-gray-50 z-10",children:e.jsxs("tr",{className:"border-b border-gray-100",children:[e.jsx("th",{className:"px-4 py-3 text-left font-medium text-gray-600",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-gray-600",children:"User"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-gray-600",children:"Details"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-gray-600",children:"Credits"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-gray-600",children:"Model"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-gray-600",children:"Voice ID"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-gray-600",children:"Time"})]})}),e.jsx("tbody",{children:M.filter(s=>s.type==="task").slice(0,20).map((s,L)=>{let E={};try{E=typeof s.metadata_json=="string"?JSON.parse(s.metadata_json):s.metadata_json||{}}catch{E={}}return e.jsxs("tr",{className:"border-b border-gray-50 hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-2.5",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${s.status==="completed"?"bg-emerald-100 text-emerald-700":s.status==="failed"?"bg-red-100 text-red-700":s.status==="processing"?"bg-blue-100 text-blue-700":s.status==="pending"?"bg-yellow-100 text-yellow-700":s.status==="queued"?"bg-purple-100 text-purple-700":(s.status==="cancelled","bg-gray-100 text-gray-700")}`,children:s.status})}),e.jsx("td",{className:"px-4 py-2.5",children:e.jsx("span",{className:"font-medium text-sm",children:s.user_nickname})}),e.jsx("td",{className:"px-4 py-2.5 max-w-[200px] truncate text-gray-600 text-xs",title:s.prompt,children:s.prompt||"-"}),e.jsx("td",{className:"px-4 py-2.5 text-gray-600 text-xs",children:s.char_count?s.char_count.toLocaleString():"-"}),e.jsx("td",{className:"px-4 py-2.5 text-gray-600 text-xs",children:s.model||E.model_id||"-"}),e.jsx("td",{className:"px-4 py-2.5 text-gray-600 text-xs",title:E.voice_id||"",children:E.voice_id?E.voice_id.slice(0,12)+"...":"-"}),e.jsx("td",{className:"px-4 py-2.5 text-gray-500 text-xs",children:s.created_at_ms?new Date(s.created_at_ms).toLocaleString():"-"})]},s.id||L)})})]})}),M.length>20&&e.jsxs("div",{className:"px-4 py-2 bg-gray-50 border-t border-gray-100 text-center text-xs text-gray-500",children:["Showing 20 of ",M.length," entries"]})]}):q.length===0?e.jsxs(z,{className:"p-8 text-center",children:[e.jsx(Re,{className:"w-12 h-12 text-gray-200 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"No logs yet"})]}):e.jsx(z,{className:"overflow-hidden",children:e.jsx("div",{className:"max-h-[600px] overflow-y-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"sticky top-0 bg-gray-50 z-10",children:e.jsxs("tr",{className:"border-b border-gray-100",children:[e.jsx("th",{className:"px-4 py-3 text-left font-medium text-gray-600",children:"Level"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-gray-600",children:"Type"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-gray-600",children:"User"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-gray-600",children:"Message"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-gray-600",children:"Time"})]})}),e.jsx("tbody",{children:q.slice(0,50).map(s=>e.jsxs("tr",{className:"border-b border-gray-50 hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-2.5 text-xs text-gray-600",children:s.level||"-"}),e.jsx("td",{className:"px-4 py-2.5 text-xs text-gray-700",children:s.event_type||"-"}),e.jsx("td",{className:"px-4 py-2.5 text-xs font-medium",children:s.user_nickname||(s.user_id?s.user_id.slice(0,8):"System")}),e.jsx("td",{className:"px-4 py-2.5 text-xs text-gray-600 max-w-[420px] truncate",title:s.message,children:s.message||"-"}),e.jsx("td",{className:"px-4 py-2.5 text-xs text-gray-500",children:s.created_at_ms?new Date(s.created_at_ms).toLocaleString():"-"})]},s.id))})]})})})]}),a==="users"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Je,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{placeholder:"Search users...",value:de,onChange:s=>h(s.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg bg-white"})]}),e.jsx(J,{variant:"secondary",onClick:d,children:e.jsx(Ge,{className:"w-4 h-4"})})]}),e.jsx(z,{className:"overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left font-medium text-gray-600",children:"User"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-gray-600",children:"Credits"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-gray-600",children:"Referrals"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-gray-600",children:"Voice Slots"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-gray-600",children:"Image Slots"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-gray-600",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left font-medium text-gray-600",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:H.map(s=>{const L=s.credit_packages?.reduce((E,se)=>E+se.credits_remaining,0)||0;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-medium",children:s.nickname}),e.jsx("div",{className:"text-xs text-gray-500",children:s.email||s.id.slice(0,8)})]}),e.jsxs("td",{className:"px-4 py-3 text-sm",children:[e.jsx("div",{className:"font-medium",children:L.toLocaleString()}),s.credit_packages&&s.credit_packages.length>0&&e.jsxs("div",{className:"text-xs text-gray-500 mt-0.5",children:[s.credit_packages.length," package",s.credit_packages.length!==1?"s":""]})]}),e.jsx("td",{className:"px-4 py-3 text-sm",children:s.referral_count>0?e.jsx("button",{onClick:async()=>{try{const E=await S.request(`/api/admin/users/${s.id}/referrals`,{admin:!0});l(`Referrals: ${E.referrals.map(se=>se.nickname).join(", ")}`,"info")}catch(E){l(E.message,"error")}},className:"font-medium text-blue-600 hover:text-blue-800 hover:underline",children:s.referral_count}):e.jsx("span",{className:"text-gray-400",children:"0"})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:`font-medium ${(s.active_tasks||0)>(s.concurrent_slots||1)?"text-red-600":"text-gray-900"}`,children:[s.active_tasks||0,"/",s.concurrent_slots||1]}),(s.active_tasks||0)>(s.concurrent_slots||1)&&e.jsx("span",{className:"text-xs px-1.5 py-0.5 bg-red-100 text-red-700 rounded",children:"!"})]})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:`font-medium ${(s.active_image_tasks||0)>(s.image_concurrent_slots||3)?"text-red-600":"text-gray-900"}`,children:[s.active_image_tasks||0,"/",s.image_concurrent_slots||3]}),(s.active_image_tasks||0)>(s.image_concurrent_slots||3)&&e.jsx("span",{className:"text-xs px-1.5 py-0.5 bg-red-100 text-red-700 rounded",children:"!"})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${s.is_active?"bg-emerald-100 text-emerald-700":"bg-red-100 text-red-700"}`,children:s.is_active?"Active":"Disabled"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(J,{variant:"ghost",size:"sm",onClick:async()=>{try{const E=await S.request(`/api/admin/users/${s.id}/packages`,{admin:!0});X({...s,credit_packages:E.packages||[]})}catch{l("Failed to load packages","error"),X({...s,credit_packages:[]})}},children:e.jsx(Ze,{className:"w-4 h-4"})})})]},s.id)})})]})}),ce>20&&e.jsxs("div",{className:"flex justify-center gap-2",children:[e.jsx(J,{variant:"secondary",size:"sm",disabled:Y===1,onClick:()=>K(s=>s-1),children:"Previous"}),e.jsxs("span",{className:"px-4 py-2 text-sm",children:["Page ",Y]}),e.jsx(J,{variant:"secondary",size:"sm",disabled:Y*20>=ce,onClick:()=>K(s=>s+1),children:"Next"})]})]}),a==="keys"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("p",{className:"text-sm text-gray-500",children:[te.length," API keys in pool"]}),p&&e.jsxs("span",{className:"px-2 py-1 bg-emerald-100 text-emerald-700 text-xs rounded-full font-medium",children:[p.voicer_total_concurrent||0," active slots"]})]}),e.jsxs(J,{onClick:()=>O(!0),children:[e.jsx(Oe,{className:"w-4 h-4"})," Add Key"]})]}),e.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-3 gap-4",children:te.map(s=>{const E=p?.api_keys?.find(ue=>ue.key_id===s.id)?.current_concurrent||0,se=E/s.concurrent_limit*100;return e.jsxs(z,{className:`p-4 ${s.is_active?"":"opacity-50"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsx("span",{className:`px-1.5 py-0.5 text-[10px] font-medium rounded ${s.provider==="elevenlabs"?"bg-purple-100 text-purple-700":s.provider==="imaginator"||s.provider==="fast_api"||s.provider==="voidai"||s.provider==="naga"?"bg-emerald-100 text-emerald-700":"bg-blue-100 text-blue-700"}`,children:s.provider==="elevenlabs"?"ElevenLabs":s.provider==="imaginator"||s.provider==="fast_api"?"Imaginator API":s.provider==="voidai"?"VoidAI API":s.provider==="naga"?"Naga API":"Voicer"})]}),e.jsx("p",{className:"text-xs text-gray-400 font-mono",children:s.api_key})]}),e.jsx("button",{onClick:()=>ee(s.id,{is_active:!s.is_active}),className:`px-2 py-1 text-xs rounded-full ${s.is_active?"bg-emerald-100 text-emerald-700":"bg-red-100 text-red-700"}`,children:s.is_active?"Active":"Off"})]}),s.provider!=="elevenlabs"&&s.provider!=="imaginator"&&s.provider!=="fast_api"&&s.provider!=="voidai"&&s.provider!=="naga"&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Concurrent Slots"}),e.jsxs("span",{className:`text-sm font-bold ${E>0?"text-emerald-600":"text-gray-400"}`,children:[E," / ",s.concurrent_limit]})]}),e.jsx("div",{className:"w-full h-3 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full transition-all duration-300 ${E>0?"bg-emerald-500":"bg-gray-300"}`,style:{width:`${Math.min(100,se)}%`}})}),E>0&&e.jsxs("p",{className:"text-xs text-emerald-600 mt-1 flex items-center gap-1",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-emerald-500 rounded-full animate-pulse"}),s.concurrent_limit-E," slots available"]})]}),s.provider==="elevenlabs"&&e.jsx("div",{className:"mb-4 p-2 bg-purple-50 rounded-lg",children:e.jsx("p",{className:"text-xs text-purple-700",children:"Used for Voice Library browsing"})}),(s.provider==="imaginator"||s.provider==="fast_api"||s.provider==="voidai"||s.provider==="naga")&&e.jsx("div",{className:"mb-4 p-2 bg-emerald-50 rounded-lg",children:e.jsx("p",{className:"text-xs text-emerald-700",children:s.provider==="voidai"?"Used for VoidAI Image Generation":s.provider==="naga"?"Used for Naga Image Generation":"Used for Image Generation"})}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-400",children:[e.jsx("span",{children:s.provider==="elevenlabs"?"Library access only":s.provider==="imaginator"||s.provider==="fast_api"||s.provider==="voidai"||s.provider==="naga"?`${s.total_requests||0} image generations`:`${s.total_requests||0} total requests`}),e.jsx(J,{variant:"ghost",size:"sm",onClick:()=>re(s.id),children:e.jsx(We,{className:"w-3 h-3 text-red-400"})})]})]},s.id)})})]}),e.jsx($e,{open:A,onClose:()=>O(!1),title:"Add API Key",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Provider"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>T({...y,provider:"voicer"}),className:`p-4 rounded-xl border-2 transition-all text-left ${y.provider==="voicer"?"border-black bg-gray-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Be,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium text-sm",children:"Voicer"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Voice generation"})]}),e.jsxs("button",{type:"button",onClick:()=>T({...y,provider:"elevenlabs"}),className:`p-4 rounded-xl border-2 transition-all text-left ${y.provider==="elevenlabs"?"border-black bg-gray-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(ts,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium text-sm",children:"ElevenLabs"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Voice library"})]}),e.jsxs("button",{type:"button",onClick:()=>T({...y,provider:"imaginator"}),className:`p-4 rounded-xl border-2 transition-all text-left ${y.provider==="imaginator"?"border-black bg-gray-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Ee,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium text-sm",children:"Imaginator API"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Image generation"})]}),e.jsxs("button",{type:"button",onClick:()=>T({...y,provider:"voidai"}),className:`p-4 rounded-xl border-2 transition-all text-left ${y.provider==="voidai"?"border-black bg-gray-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Ee,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium text-sm",children:"VoidAI API"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Image generation"})]}),e.jsxs("button",{type:"button",onClick:()=>T({...y,provider:"naga"}),className:`p-4 rounded-xl border-2 transition-all text-left ${y.provider==="naga"?"border-black bg-gray-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Ee,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium text-sm",children:"Naga API"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Image generation (DALL·E 3, Flux, etc.)"})]})]})]}),e.jsx(ke,{label:"Name",placeholder:y.provider==="voicer"?"My Voicer Key":y.provider==="imaginator"||y.provider==="fast_api"?"My Imaginator API Key":y.provider==="voidai"?"My VoidAI API Key":y.provider==="naga"?"My Naga API Key":"My ElevenLabs Key",value:y.name,onChange:s=>T({...y,name:s.target.value})}),e.jsx(ke,{label:"API Key",placeholder:y.provider==="voicer"?"Enter Voicer API key...":y.provider==="imaginator"||y.provider==="fast_api"?"Enter Imaginator API key...":y.provider==="voidai"?"Enter VoidAI API key (sk-voidai-...)...":y.provider==="naga"?"Enter Naga API key...":"Enter ElevenLabs API key...",value:y.api_key,onChange:s=>T({...y,api_key:s.target.value})}),y.provider==="voicer"&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(ke,{label:"Hourly Limit",type:"number",value:y.hourly_limit,onChange:s=>T({...y,hourly_limit:parseInt(s.target.value)||2e3})}),e.jsx(ke,{label:"Concurrent Limit",type:"number",value:y.concurrent_limit,onChange:s=>T({...y,concurrent_limit:parseInt(s.target.value)||10})})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx(J,{variant:"secondary",onClick:()=>O(!1),children:"Cancel"}),e.jsx(J,{onClick:B,disabled:!y.name||!y.api_key,children:"Create"})]})]})}),a==="pricing"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Image Model Pricing"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Set credits cost per image for each model"})]})}),e.jsx(z,{className:"p-6",children:e.jsx("div",{className:"space-y-4",children:[{id:"IMAGEN_3_5",name:"Imagen 3.5",model:"imagen3.5",defaultCredits:1},{id:"GEM_PIX",name:"GEM_PIX (Nano Banana)",model:"nano_banana",defaultCredits:1},{id:"GEM_PIX_2",name:"GEM_PIX_2 (Nano Banana Pro)",model:"nano_banana_pro",defaultCredits:2},{id:"NAGA_DALLE3",name:"DALL·E 3",model:"dall-e-3:free",defaultCredits:1},{id:"NAGA_FLUX",name:"Flux Schnell",model:"flux-1-schnell:free",defaultCredits:1}].map(s=>{const L=ge.find(se=>se.model_id===s.id)||{model_id:s.id,credits_per_image:s.defaultCredits},E=j===s.id;return e.jsx("div",{className:"p-4 border-2 border-gray-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Model ID: ",s.model]})]}),e.jsx("div",{className:"flex items-center gap-4",children:E?e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"number",min:"1",max:"100000",value:L.credits_per_image,onChange:se=>{const ue=ge.map(me=>me.model_id===s.id?{...me,credits_per_image:parseInt(se.target.value)||1}:me);ue.find(me=>me.model_id===s.id)||ue.push({model_id:s.id,credits_per_image:parseInt(se.target.value)||1}),n(ue)},className:"w-20 px-3 py-2 border-2 border-gray-300 rounded-lg text-center font-semibold"}),e.jsx(J,{size:"sm",onClick:()=>{F(s.id,L.credits_per_image),r(null)},children:"Save"}),e.jsx(J,{variant:"secondary",size:"sm",onClick:()=>{r(null),u()},children:"Cancel"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:L.credits_per_image}),e.jsx("div",{className:"text-xs text-gray-500",children:"credits/image"})]}),e.jsxs(J,{variant:"secondary",size:"sm",onClick:()=>r(s.id),children:[e.jsx(Ze,{className:"w-4 h-4"})," Edit"]})]})})]})},s.id)})})})]}),e.jsx($e,{open:!!I,onClose:()=>X(null),title:"Edit User",children:I&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-0.5",children:"Username"}),e.jsx("p",{className:"font-medium",children:I.nickname})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Credit Packages"}),e.jsxs(J,{variant:"secondary",size:"sm",onClick:()=>U(!0),children:[e.jsx(Oe,{className:"w-3 h-3"})," Add Package"]})]}),I.credit_packages&&I.credit_packages.length>0?e.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:I.credit_packages.map(s=>{const L=new Date(s.expires_at_ms),E=new Date(s.created_at_ms),se=Math.ceil((s.expires_at_ms-Date.now())/(24*60*60*1e3)),ue=((s.credits_initial-s.credits_remaining)/s.credits_initial*100).toFixed(0);return e.jsxs("div",{className:"p-3 bg-white border-2 border-gray-200 rounded-lg relative group",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"text-sm font-bold text-gray-900",children:[s.credits_remaining.toLocaleString()," / ",s.credits_initial.toLocaleString()]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-0.5",children:[ue,"% used"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:`text-xs px-2 py-1 rounded-full font-medium ${se<=7?"bg-red-100 text-red-700":se<=14?"bg-orange-100 text-orange-700":"bg-emerald-100 text-emerald-700"}`,children:[se,"d"]}),e.jsxs("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity flex gap-1",children:[e.jsx("button",{onClick:()=>{const me=Math.round((s.expires_at_ms-s.created_at_ms)/864e5);pe(s),oe({credits:s.credits_remaining,duration_days:[30,60,90].includes(me)?me:30})},className:"p-1 hover:bg-blue-50 rounded",title:"Edit",children:e.jsx(Ze,{className:"w-3 h-3 text-blue-500"})}),e.jsx("button",{onClick:()=>{confirm("Delete this package?")&&P(s.id)},className:"p-1 hover:bg-red-50 rounded",title:"Delete",children:e.jsx(We,{className:"w-3 h-3 text-red-500"})})]})]})]}),e.jsxs("div",{className:"text-xs text-gray-500 space-y-0.5",children:[e.jsxs("div",{children:["Created: ",E.toLocaleDateString()]}),e.jsxs("div",{children:["Expires: ",L.toLocaleDateString()]}),s.source&&e.jsxs("div",{className:"text-gray-400",children:["Source: ",s.source]})]}),e.jsx("div",{className:"mt-2 w-full bg-gray-200 rounded-full h-1.5",children:e.jsx("div",{className:`h-1.5 rounded-full ${se<=7?"bg-red-500":se<=14?"bg-orange-500":"bg-emerald-500"}`,style:{width:`${100-ue}%`}})})]},s.id)})}):e.jsx("div",{className:"p-6 text-center border-2 border-dashed border-gray-200 rounded-lg",children:e.jsx("p",{className:"text-sm text-gray-500",children:"No active credit packages"})}),e.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:["Total available: ",I.credit_packages?.reduce((s,L)=>s+L.credits_remaining,0).toLocaleString()||0," credits"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Voice Concurrent Slots"}),e.jsx("input",{type:"number",min:"1",max:"50",value:I.concurrent_slots||1,onChange:s=>X({...I,concurrent_slots:parseInt(s.target.value)}),className:"w-full px-4 py-2.5 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-gray-900"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Number of simultaneous voice generation tasks allowed"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Image Concurrent Slots"}),e.jsx("input",{type:"number",min:"1",max:"50",value:I.image_concurrent_slots||3,onChange:s=>X({...I,image_concurrent_slots:parseInt(s.target.value)}),className:"w-full px-4 py-2.5 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-gray-900"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Number of simultaneous image generation tasks allowed (default: 3)"})]}),e.jsx(ws,{label:"Account Status",description:I.is_active?"User can access the service":"User is blocked",checked:I.is_active,onChange:s=>X({...I,is_active:s})}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx(J,{variant:"secondary",onClick:()=>X(null),children:"Cancel"}),e.jsx(J,{onClick:i,children:"Save Changes"})]})]})}),e.jsx($e,{open:Q,onClose:()=>U(!1),title:"Add Credit Package",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Credits Amount"}),e.jsx("input",{type:"number",min:"1000000",max:"50000000",step:"1000000",value:Z.credits,onChange:s=>oe({...Z,credits:s.target.value}),className:"w-full px-4 py-2.5 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-gray-900",placeholder:"Enter credits (1M - 50M)"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Min: 1,000,000 | Max: 50,000,000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Validity Period"}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:[{days:30,label:"1 Month"},{days:60,label:"2 Months"},{days:90,label:"3 Months"}].map(s=>e.jsx("button",{onClick:()=>oe({...Z,duration_days:s.days}),className:`px-4 py-3 rounded-lg border-2 font-semibold text-sm transition-all ${Z.duration_days===s.days?"border-gray-900 bg-gray-900 text-white":"border-gray-300 bg-white text-gray-700 hover:border-gray-900"}`,children:s.label},s.days))})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx(J,{variant:"secondary",onClick:()=>U(!1),children:"Cancel"}),e.jsx(J,{onClick:k,children:"Add Package"})]})]})}),e.jsx($e,{open:!!le,onClose:()=>pe(null),title:"Edit Credit Package",children:le&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Package Info"}),e.jsxs("p",{className:"text-sm font-medium mt-1",children:["Initial: ",le.credits_initial.toLocaleString()," credits"]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Created: ",new Date(le.created_at_ms).toLocaleDateString()]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Credits Remaining"}),e.jsx("input",{type:"number",min:"0",max:le.credits_initial,value:Z.credits,onChange:s=>oe({...Z,credits:s.target.value}),className:"w-full px-4 py-2.5 border-2 border-gray-300 rounded-lg focus:outline-none focus:border-gray-900"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Max: ",le.credits_initial.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Validity Period"}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:[{days:30,label:"1 Month"},{days:60,label:"2 Months"},{days:90,label:"3 Months"}].map(s=>e.jsx("button",{onClick:()=>oe({...Z,duration_days:s.days}),className:`px-4 py-3 rounded-lg border-2 font-semibold text-sm transition-all ${Z.duration_days===s.days?"border-gray-900 bg-gray-900 text-white":"border-gray-300 bg-white text-gray-700 hover:border-gray-900"}`,children:s.label},s.days))}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"This will update the expiration date from creation time"})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx(J,{variant:"secondary",onClick:()=>pe(null),children:"Cancel"}),e.jsx(J,{onClick:w,children:"Save Changes"})]})]})})]})]})}function Zs(){return e.jsxs("div",{className:"max-w-4xl mx-auto space-y-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Terms of Service"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Last updated: January 20, 2026"})]}),e.jsxs(z,{className:"p-6 space-y-6",children:[e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"1. Acceptance of Terms"}),e.jsx("p",{className:"text-gray-700 leading-relaxed",children:'By accessing and using FiftyFive Labs ("Service"), you accept and agree to be bound by these Terms of Service. If you do not agree to these terms, please do not use our Service.'})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"2. Use of Third-Party Services"}),e.jsxs("div",{className:"space-y-3 text-gray-700 leading-relaxed",children:[e.jsxs("p",{children:[e.jsx("strong",{className:"text-gray-900",children:"Important Notice:"})," FiftyFive Labs utilizes various third-party AI services and APIs to provide affordable content generation capabilities. These services include, but are not limited to:"]}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 ml-4",children:[e.jsx("li",{children:"ElevenLabs and other voice synthesis providers"}),e.jsx("li",{children:"AI model providers and inference platforms"}),e.jsx("li",{children:"Cloud infrastructure and storage services"})]}),e.jsxs("p",{children:[e.jsx("strong",{className:"text-red-600",children:"We do not own, operate, or control these third-party services."})," As such:"]}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 ml-4 text-gray-700",children:[e.jsxs("li",{children:["We are ",e.jsx("strong",{children:"not responsible"})," for the availability, reliability, or performance of third-party services"]}),e.jsx("li",{children:"We do not guarantee uptime, quality, or consistency of generated content"}),e.jsx("li",{children:"Service interruptions, outages, or quality degradation may occur without notice"}),e.jsx("li",{children:"We make no warranties regarding the accuracy or suitability of generated content"})]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"3. User Responsibility for Content"}),e.jsxs("div",{className:"space-y-3 text-gray-700 leading-relaxed",children:[e.jsx("p",{className:"text-red-600 font-medium",children:"YOU ARE SOLELY RESPONSIBLE FOR ALL CONTENT YOU GENERATE USING OUR SERVICE."}),e.jsx("p",{children:"This includes but is not limited to:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 ml-4",children:[e.jsx("li",{children:"Ensuring you have the legal right to generate and use the content"}),e.jsx("li",{children:"Verifying that your content does not infringe on any copyrights, trademarks, or intellectual property rights"}),e.jsx("li",{children:"Ensuring compliance with all applicable laws and regulations in your jurisdiction"}),e.jsx("li",{children:"Not generating content that is illegal, harmful, threatening, abusive, harassing, defamatory, or otherwise objectionable"}),e.jsx("li",{children:"Not impersonating any person or entity, or falsely representing your affiliation"}),e.jsx("li",{children:"Not generating content for fraudulent, malicious, or deceptive purposes"})]}),e.jsxs("p",{children:["FiftyFive Labs ",e.jsx("strong",{children:"DOES NOT"})," review, monitor, or validate user-generated content. We assume no liability for any content generated through our Service."]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"4. Prohibited Uses"}),e.jsxs("div",{className:"space-y-3 text-gray-700 leading-relaxed",children:[e.jsx("p",{children:"You agree NOT to use the Service for:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 ml-4",children:[e.jsx("li",{children:"Illegal activities or content that violates any laws"}),e.jsx("li",{children:"Harassment, abuse, or threats against individuals or groups"}),e.jsx("li",{children:"Generating deepfakes, impersonations, or misleading content without proper disclosure"}),e.jsx("li",{children:"Spam, phishing, or other fraudulent activities"}),e.jsx("li",{children:"Violating intellectual property rights of others"}),e.jsx("li",{children:"Circumventing service limitations or attempting unauthorized access"}),e.jsx("li",{children:"Reselling or redistributing our Service without authorization"})]}),e.jsx("p",{className:"text-red-600 font-medium",children:"Violation of these terms may result in immediate account termination without refund."})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"5. Payment and Credits"}),e.jsx("div",{className:"space-y-3 text-gray-700 leading-relaxed",children:e.jsxs("ul",{className:"list-disc list-inside space-y-2 ml-4",children:[e.jsx("li",{children:"Credits are purchased packages that enable content generation"}),e.jsx("li",{children:"Credits have an expiration date specified at time of purchase"}),e.jsx("li",{children:"Credit consumption is based on character count, model selection, and other factors"}),e.jsx("li",{children:"Pricing is subject to change; existing credit packages honor purchase-time rates"}),e.jsx("li",{children:"All sales are final (see Refund Policy below)"})]})})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"6. No Refund Policy"}),e.jsxs("div",{className:"space-y-3 text-gray-700 leading-relaxed",children:[e.jsx("p",{className:"text-red-600 font-bold text-lg",children:"ALL PURCHASES ARE FINAL. NO REFUNDS WILL BE ISSUED."}),e.jsx("p",{children:"Due to the nature of digital services and instant credit delivery:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 ml-4",children:[e.jsxs("li",{children:["Refunds are ",e.jsx("strong",{children:"NOT"})," available for any reason, including but not limited to:",e.jsxs("ul",{className:"list-circle list-inside ml-6 mt-2 space-y-1",children:[e.jsx("li",{children:"Change of mind or accidental purchases"}),e.jsx("li",{children:"Service unavailability or downtime"}),e.jsx("li",{children:"Quality of generated content not meeting expectations"}),e.jsx("li",{children:"Unused or expired credits"}),e.jsx("li",{children:"Account suspension or termination due to Terms violation"})]})]}),e.jsx("li",{children:"Credits cannot be transferred, exchanged, or redeemed for cash"}),e.jsx("li",{children:"Please carefully review your purchase before confirming payment"})]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"7. Service Availability"}),e.jsxs("div",{className:"space-y-3 text-gray-700 leading-relaxed",children:[e.jsxs("p",{children:["We strive to provide reliable service, but ",e.jsx("strong",{children:"we do NOT guarantee"}),":"]}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 ml-4",children:[e.jsx("li",{children:"Uninterrupted or error-free operation"}),e.jsx("li",{children:"Availability of specific AI models or features"}),e.jsx("li",{children:"Maintenance-free service (scheduled or emergency maintenance may occur)"}),e.jsx("li",{children:"Compatibility with all devices, browsers, or network configurations"})]}),e.jsx("p",{children:"We reserve the right to modify, suspend, or discontinue any aspect of the Service at any time without notice."})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"8. Limitation of Liability"}),e.jsxs("div",{className:"space-y-3 text-gray-700 leading-relaxed",children:[e.jsx("p",{className:"text-red-600 font-medium",children:"TO THE MAXIMUM EXTENT PERMITTED BY LAW:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 ml-4",children:[e.jsx("li",{children:'FiftyFive Labs is provided "AS IS" and "AS AVAILABLE" without warranties of any kind'}),e.jsx("li",{children:"We disclaim all warranties, express or implied, including merchantability and fitness for a particular purpose"}),e.jsx("li",{children:"We are not liable for any direct, indirect, incidental, consequential, or punitive damages"}),e.jsx("li",{children:"Our total liability shall not exceed the amount you paid in the last 30 days"}),e.jsx("li",{children:"We are not responsible for losses due to third-party service failures, data loss, or security breaches"})]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"9. Intellectual Property"}),e.jsx("div",{className:"space-y-3 text-gray-700 leading-relaxed",children:e.jsxs("ul",{className:"list-disc list-inside space-y-2 ml-4",children:[e.jsx("li",{children:"You retain ownership of content you input into the Service"}),e.jsx("li",{children:"Generated content ownership may be subject to third-party AI provider terms"}),e.jsx("li",{children:"FiftyFive Labs and its branding are our intellectual property"}),e.jsx("li",{children:"You may not reproduce, modify, or create derivative works of our platform without permission"})]})})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"10. Privacy and Data"}),e.jsxs("div",{className:"space-y-3 text-gray-700 leading-relaxed",children:[e.jsxs("p",{children:["Your use of the Service is also governed by our ",e.jsx("a",{href:"/privacy",className:"text-blue-600 hover:underline",children:"Privacy Policy"}),". By using our Service, you consent to:"]}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 ml-4",children:[e.jsx("li",{children:"Collection and processing of your data as described in our Privacy Policy"}),e.jsx("li",{children:"Transmission of your content to third-party AI providers for processing"}),e.jsx("li",{children:"Storage of generated content and metadata for service operation"})]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"11. Account Security"}),e.jsx("div",{className:"space-y-3 text-gray-700 leading-relaxed",children:e.jsxs("ul",{className:"list-disc list-inside space-y-2 ml-4",children:[e.jsx("li",{children:"You are responsible for maintaining the security of your account credentials"}),e.jsx("li",{children:"You must notify us immediately of any unauthorized access"}),e.jsx("li",{children:"We are not liable for losses due to unauthorized account access"}),e.jsx("li",{children:"Sharing accounts or API keys is prohibited"})]})})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"12. Termination"}),e.jsxs("div",{className:"space-y-3 text-gray-700 leading-relaxed",children:[e.jsx("p",{children:"We reserve the right to suspend or terminate your account at any time for:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 ml-4",children:[e.jsx("li",{children:"Violation of these Terms of Service"}),e.jsx("li",{children:"Fraudulent activity or payment disputes"}),e.jsx("li",{children:"Abuse of the Service or its resources"}),e.jsx("li",{children:"Any reason at our sole discretion"})]}),e.jsx("p",{className:"text-red-600 font-medium",children:"Account termination does not entitle you to any refunds of unused credits."})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"13. Changes to Terms"}),e.jsx("div",{className:"space-y-3 text-gray-700 leading-relaxed",children:e.jsx("p",{children:"We may modify these Terms at any time. Continued use of the Service after changes constitutes acceptance of the new Terms. Material changes will be communicated via email or service notification."})})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"14. Governing Law"}),e.jsx("div",{className:"space-y-3 text-gray-700 leading-relaxed",children:e.jsx("p",{children:"These Terms are governed by applicable international laws. Any disputes shall be resolved through binding arbitration or in courts of competent jurisdiction."})})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"15. Contact"}),e.jsx("div",{className:"space-y-3 text-gray-700 leading-relaxed",children:e.jsxs("p",{children:["For questions about these Terms, please contact us at: ",e.jsx("strong",{children:"support@fiftyfivelabs.com"})]})})]}),e.jsx("div",{className:"border-t border-gray-200 pt-6 mt-8",children:e.jsx("p",{className:"text-sm text-gray-500 italic",children:"By using FiftyFive Labs, you acknowledge that you have read, understood, and agree to be bound by these Terms of Service."})})]})]})}function et(){return e.jsxs("div",{className:"max-w-4xl mx-auto space-y-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Privacy Policy"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Last updated: January 20, 2026"})]}),e.jsxs(z,{className:"p-6 space-y-6",children:[e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"1. Information We Collect"}),e.jsxs("div",{className:"space-y-3 text-gray-700 leading-relaxed",children:[e.jsx("p",{children:e.jsx("strong",{children:"Account Information:"})}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 ml-4",children:[e.jsx("li",{children:"Email address, username, and profile information"}),e.jsx("li",{children:"Payment information (processed through third-party payment providers)"}),e.jsx("li",{children:"Account preferences and settings"})]}),e.jsx("p",{className:"mt-3",children:e.jsx("strong",{children:"Usage Data:"})}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 ml-4",children:[e.jsx("li",{children:"Generated content requests and metadata"}),e.jsx("li",{children:"API usage statistics and logs"}),e.jsx("li",{children:"Credit usage and transaction history"}),e.jsx("li",{children:"Device information, IP address, and browser type"})]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"2. How We Use Your Information"}),e.jsx("div",{className:"space-y-3 text-gray-700 leading-relaxed",children:e.jsxs("ul",{className:"list-disc list-inside space-y-2 ml-4",children:[e.jsx("li",{children:"Provide and maintain our Service"}),e.jsx("li",{children:"Process payments and manage your account"}),e.jsx("li",{children:"Send service-related communications"}),e.jsx("li",{children:"Improve our Service and develop new features"}),e.jsx("li",{children:"Prevent fraud and ensure security"}),e.jsx("li",{children:"Comply with legal obligations"})]})})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"3. Third-Party Services"}),e.jsxs("div",{className:"space-y-3 text-gray-700 leading-relaxed",children:[e.jsx("p",{children:"We use third-party services to operate our platform. Your data may be processed by:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 ml-4",children:[e.jsx("li",{children:"AI model providers (ElevenLabs, etc.) to generate content"}),e.jsx("li",{children:"Payment processors to handle transactions"}),e.jsx("li",{children:"Cloud hosting providers for infrastructure"}),e.jsx("li",{children:"Analytics services to improve our Service"})]}),e.jsx("p",{className:"text-amber-600 font-medium",children:"These third parties have their own privacy policies. We recommend reviewing them."})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"4. Data Retention"}),e.jsx("div",{className:"space-y-3 text-gray-700 leading-relaxed",children:e.jsxs("ul",{className:"list-disc list-inside space-y-2 ml-4",children:[e.jsx("li",{children:"Account data is retained while your account is active"}),e.jsx("li",{children:"Generated content is stored based on your subscription tier"}),e.jsx("li",{children:"Logs and analytics data are retained for operational purposes"}),e.jsx("li",{children:"You may request account deletion by contacting support"})]})})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"5. Data Security"}),e.jsx("div",{className:"space-y-3 text-gray-700 leading-relaxed",children:e.jsx("p",{children:"We implement reasonable security measures to protect your data, including encryption, access controls, and secure protocols. However, no method of transmission over the Internet is 100% secure."})})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"6. Your Rights"}),e.jsxs("div",{className:"space-y-3 text-gray-700 leading-relaxed",children:[e.jsx("p",{children:"You have the right to:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 ml-4",children:[e.jsx("li",{children:"Access your personal data"}),e.jsx("li",{children:"Correct inaccurate data"}),e.jsx("li",{children:"Request deletion of your data"}),e.jsx("li",{children:"Object to processing of your data"}),e.jsx("li",{children:"Export your data"})]}),e.jsxs("p",{children:["Contact us at ",e.jsx("strong",{children:"privacy@fiftyfivelabs.com"})," to exercise these rights."]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"7. Cookies and Tracking"}),e.jsx("div",{className:"space-y-3 text-gray-700 leading-relaxed",children:e.jsx("p",{children:"We use cookies and similar technologies to maintain sessions, remember preferences, and analyze usage. You can control cookies through your browser settings."})})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"8. Changes to Privacy Policy"}),e.jsx("div",{className:"space-y-3 text-gray-700 leading-relaxed",children:e.jsx("p",{children:"We may update this Privacy Policy from time to time. We will notify you of significant changes via email or service notification."})})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"9. Contact"}),e.jsx("div",{className:"space-y-3 text-gray-700 leading-relaxed",children:e.jsxs("p",{children:["For privacy-related questions, contact: ",e.jsx("strong",{children:"privacy@fiftyfivelabs.com"})]})})]})]})]})}function st(){const l=new Date().getFullYear();return e.jsx("footer",{className:"bg-white border-t border-gray-100 mt-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 mb-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"w-8 h-8 bg-black rounded-lg flex items-center justify-center",children:e.jsx(Me,{className:"w-4 h-4 text-white"})}),e.jsx("span",{className:"font-semibold text-gray-900",children:"FiftyFive Labs"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Affordable AI-powered voice generation platform using cutting-edge third-party services."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Legal"}),e.jsxs("ul",{className:"space-y-2 text-sm",children:[e.jsx("li",{children:e.jsx("button",{onClick:()=>{window.history.pushState({},"","/terms"),window.dispatchEvent(new PopStateEvent("popstate"))},className:"text-gray-600 hover:text-gray-900 transition-colors",children:"Terms of Service"})}),e.jsx("li",{children:e.jsx("button",{onClick:()=>{window.history.pushState({},"","/privacy"),window.dispatchEvent(new PopStateEvent("popstate"))},className:"text-gray-600 hover:text-gray-900 transition-colors",children:"Privacy Policy"})})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Support"}),e.jsxs("ul",{className:"space-y-2 text-sm",children:[e.jsxs("li",{className:"text-gray-600",children:["Email: ",e.jsx("a",{href:"mailto:support@fiftyfivelabs.com",className:"hover:text-gray-900",children:"support@fiftyfivelabs.com"})]}),e.jsxs("li",{className:"text-gray-600",children:["Privacy: ",e.jsx("a",{href:"mailto:privacy@fiftyfivelabs.com",className:"hover:text-gray-900",children:"privacy@fiftyfivelabs.com"})]})]})]})]}),e.jsxs("div",{className:"border-t border-gray-100 pt-6",children:[e.jsxs("p",{className:"text-xs text-gray-500 mb-3",children:[e.jsx("strong",{children:"Disclaimer:"})," FiftyFive Labs uses third-party AI services for content generation. We are not responsible for the availability, reliability, or quality of these external services. All purchases are final with no refunds. Users are solely responsible for generated content and its legal compliance."]}),e.jsxs("p",{className:"text-xs text-gray-400",children:["© ",l," FiftyFive Labs. All rights reserved."]})]})]})})}function tt({user:l,setUser:c,showToast:a}){const[o,g]=t.useState("voice"),[m,p]=t.useState(!1);t.useEffect(()=>{const b=window.location.pathname,M={"/generate/voice":"voice","/generatevoice":"voice","/generate/image":"image","/library/voice":"library","/libraryvoice":"library","/history":"history","/apikeys":"api","/pricing":"pricing","/profile":"profile","/terms":"terms","/privacy":"privacy"}[b];M&&M!==o?g(M):!M&&b!=="/"&&!b.startsWith("/admin")&&(window.history.replaceState({},"","/generate/voice"),g("voice"))},[]),t.useEffect(()=>{const N={voice:"/generate/voice",image:"/generate/image",library:"/library/voice",history:"/history",api:"/apikeys",pricing:"/pricing",profile:"/profile",terms:"/terms",privacy:"/privacy"}[o]||"/generate/voice";window.location.pathname!==N&&window.history.pushState({},"",N)},[o]),t.useEffect(()=>{const b=()=>{const N=window.location.pathname,W={"/generate/voice":"voice","/generatevoice":"voice","/generate/image":"image","/library/voice":"library","/libraryvoice":"library","/history":"history","/apikeys":"api","/pricing":"pricing","/profile":"profile","/terms":"terms","/privacy":"privacy"}[N];W&&g(W)};return window.addEventListener("popstate",b),()=>window.removeEventListener("popstate",b)},[]);const D=async()=>{try{const b=await S.request("/api/me");c(b.user)}catch{}},_=()=>{S.setToken(null),c(null)},v=[{id:"voice",icon:Be,label:"Generate Voice"},{id:"image",icon:Ee,label:"Generate Image"},{id:"library",icon:ts,label:"Voice Library"},{id:"history",icon:Re,label:"All History"},{id:"api",icon:Fe,label:"API Access"},{id:"pricing",icon:ps,label:"Pricing"}];return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex",children:[e.jsx("aside",{className:`fixed inset-y-0 left-0 z-40 w-64 bg-white border-r border-gray-100 transform transition-transform lg:translate-x-0 ${m?"translate-x-0":"-translate-x-full"}`,children:e.jsxs("div",{className:"h-screen flex flex-col",children:[e.jsx("div",{className:"p-5 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 bg-black rounded-xl flex items-center justify-center",children:e.jsx(Me,{className:"w-5 h-5 text-white"})}),e.jsx("span",{className:"text-lg font-semibold tracking-tight",children:"FiftyFive Labs"})]})}),e.jsx("nav",{className:"flex-1 p-3 space-y-1 overflow-y-auto",children:v.map(b=>e.jsxs("button",{onClick:()=>{g(b.id),p(!1);const M={voice:"/generate/voice",image:"/generate/image",library:"/library/voice",history:"/history",api:"/apikeys",pricing:"/pricing",profile:"/profile"}[b.id]||"/generate/voice";window.history.pushState({},"",M)},className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-xl text-sm font-medium transition-all ${o===b.id?"bg-gray-100 text-gray-900":"text-gray-600 hover:bg-gray-50"}`,children:[e.jsx(b.icon,{className:"w-5 h-5"}),b.label]},b.id))}),e.jsxs("div",{className:"p-4 border-t border-gray-100 bg-white",children:[e.jsxs("button",{type:"button",className:"flex items-center gap-3 mb-3 w-full text-left rounded-lg hover:bg-gray-50 px-2 py-1",onClick:()=>{g("profile"),window.history.pushState({},"","/profile")},children:[e.jsx("div",{className:"w-9 h-9 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx(Ps,{className:"w-5 h-5 text-gray-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:l.nickname}),e.jsxs("p",{className:"text-xs text-gray-500",children:[(l.credit_packages?.reduce((b,N)=>b+N.credits_remaining,0)||0).toLocaleString()," credits"]})]})]}),e.jsxs(J,{variant:"ghost",size:"sm",className:"w-full justify-start text-gray-500",onClick:b=>{b.stopPropagation(),_()},children:[e.jsx(hs,{className:"w-4 h-4"}),"Sign Out"]})]})]})}),m&&e.jsx("div",{className:"fixed inset-0 bg-black/20 z-30 lg:hidden",onClick:()=>p(!1)}),e.jsxs("main",{className:"flex-1 min-w-0 lg:ml-64",children:[e.jsx("header",{className:"sticky top-0 z-20 bg-white/80 backdrop-blur-md border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between px-4 lg:px-6 h-16",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>p(!0),className:"lg:hidden p-2 rounded-lg hover:bg-gray-100",children:e.jsx(Es,{className:"w-5 h-5"})}),e.jsx("h1",{className:"text-lg font-semibold",children:v.find(b=>b.id===o)?.label})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(J,{variant:"secondary",size:"sm",className:"pointer-events-none",children:[e.jsx(Me,{className:"w-4 h-4"}),e.jsx("span",{children:(l.credit_packages?.reduce((b,N)=>b+N.credits_remaining,0)||0).toLocaleString()})]}),e.jsxs(J,{variant:"secondary",size:"sm",onClick:()=>{g("pricing"),window.history.pushState({},"","/pricing")},children:[e.jsx(Ls,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Upgrade"})]})]})]})}),e.jsxs("div",{className:"p-4 lg:p-6",children:[o==="voice"&&e.jsx(Js,{user:l,refreshUser:D,showToast:a,onGoToLibrary:()=>g("library")}),e.jsx("div",{className:o==="image"?"":"hidden","aria-hidden":o!=="image",children:e.jsx(Hs,{user:l,refreshUser:D,showToast:a})}),o==="library"&&e.jsx(Bs,{showToast:a}),o==="history"&&e.jsx(Ws,{showToast:a}),o==="api"&&e.jsx(Ks,{showToast:a,user:l}),o==="profile"&&e.jsx(at,{user:l,showToast:a}),o==="pricing"&&e.jsx(Xs,{showToast:a,user:l}),o==="terms"&&e.jsx(Zs,{}),o==="privacy"&&e.jsx(et,{})]}),(o==="voice"||o==="image"||o==="library"||o==="pricing"||o==="terms"||o==="privacy")&&e.jsx(st,{})]})]})}function at({user:l,showToast:c}){const[a,o]=t.useState(null),[g,m]=t.useState(!0);t.useEffect(()=>{let _=!0;return(async()=>{m(!0);try{const b=await S.request("/api/user/profile");if(!_)return;o(b.profile)}catch(b){c(b.message,"error")}finally{_&&m(!1)}})(),()=>{_=!1}},[c]);const p=t.useMemo(()=>{const _=a?.referral?.code;return _?`${window.location.origin}/?ref=${_}`:""},[a]);if(g)return e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsx(he,{className:"w-6 h-6 animate-spin text-gray-300"})});const D=a?.credit_packages?.reduce((_,v)=>_+v.credits_remaining,0)||0;return e.jsxs("div",{className:"space-y-6 max-w-6xl",children:[e.jsxs("div",{className:"grid md:grid-cols-4 gap-4",children:[e.jsxs(z,{className:"p-4",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Total Credits"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:D.toLocaleString()})]}),e.jsxs(z,{className:"p-4",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Active Packages"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a?.credit_packages?.length||0})]}),e.jsxs(z,{className:"p-4",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Credits Used"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(a?.credits_used||0).toLocaleString()})]}),e.jsxs(z,{className:"p-4",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Referrals"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a?.referral?.referred_count||0})]})]}),a?.credit_packages&&a.credit_packages.length>0&&e.jsxs(z,{className:"p-6",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx($s,{className:"w-5 h-5"}),"Credit Packages"]}),e.jsx("div",{className:"grid md:grid-cols-3 gap-4",children:a.credit_packages.map(_=>{const v=new Date(_.expires_at_ms);new Date(_.created_at_ms);const b=Math.ceil((_.expires_at_ms-Date.now())/(24*60*60*1e3)),N=((_.credits_initial-_.credits_remaining)/_.credits_initial*100).toFixed(0);return e.jsxs("div",{className:"p-4 bg-gray-50 rounded-xl border border-gray-200",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-xl font-bold text-gray-900",children:[(_.credits_remaining/1e6).toFixed(1),"M"]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["of ",(_.credits_initial/1e6).toFixed(1),"M"]})]}),e.jsxs("div",{className:`text-xs px-2 py-1 rounded-full font-medium ${b<=7?"bg-red-100 text-red-700":b<=14?"bg-orange-100 text-orange-700":"bg-emerald-100 text-emerald-700"}`,children:[b,"d"]})]}),e.jsx("div",{className:"mb-3 w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all ${b<=7?"bg-red-500":b<=14?"bg-orange-500":"bg-emerald-500"}`,style:{width:`${100-N}%`}})}),e.jsxs("div",{className:"text-xs text-gray-500 space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Used:"}),e.jsxs("span",{className:"font-medium",children:[N,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Expires:"}),e.jsx("span",{className:"font-medium",children:v.toLocaleDateString()})]}),_.source&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Source:"}),e.jsx("span",{className:"font-medium capitalize",children:_.source})]})]})]},_.id)})})]}),e.jsxs(z,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 mb-4",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(es,{className:"w-5 h-5"}),"Referral Program"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Share and earn credits when users top up."})]}),e.jsxs(J,{size:"sm",variant:"secondary",onClick:()=>{p&&(navigator.clipboard.writeText(p),c("Copied!","success"))},disabled:!p,children:[e.jsx(as,{className:"w-4 h-4"})," Copy Link"]})]}),e.jsx("code",{className:"block w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg text-sm font-mono mb-4",children:p||"—"}),e.jsxs("div",{className:"grid sm:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"p-4 rounded-lg bg-gray-50 border border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Your Tier"}),e.jsxs("p",{className:"text-xl font-bold text-gray-900",children:[Math.round((a?.referral?.tier_rate||0)*100),"%"]})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-gray-50 border border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Referred Users"}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:(a?.referral?.referred_count||0).toLocaleString()})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-gray-50 border border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Credits Earned"}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:(a?.referral?.credits_earned||0).toLocaleString()})]})]})]}),e.jsx(_s,{stats:{__mode:"user"}})]})}function rt(){const[l,c]=t.useState(null),[a,o]=t.useState(!0),[g,m]=t.useState(null),[p,D]=t.useState(!1),[_,v]=t.useState(!1),b=(N,M="info")=>m({message:N,type:M});return t.useEffect(()=>{document.title="FiftyFive Labs | AI Studio"},[]),t.useEffect(()=>{const N=()=>{const M=window.location.pathname;D(M==="/admin"||M.startsWith("/admin/"))};return N(),window.addEventListener("popstate",N),()=>window.removeEventListener("popstate",N)},[]),t.useEffect(()=>{p&&S.adminToken&&fetch(`${ve}/api/admin/stats`,{headers:{"X-Admin-Token":S.adminToken}}).then(N=>{N.ok?v(!0):(S.setAdminToken(null),v(!1))}).catch(()=>{S.setAdminToken(null),v(!1)})},[p]),t.useEffect(()=>{!p&&S.token?S.request("/api/me").then(N=>c(N.user)).catch(()=>S.setToken(null)).finally(()=>o(!1)):p||o(!1)},[p]),p?e.jsxs(e.Fragment,{children:[_?e.jsx(Qs,{showToast:b,onLogout:()=>v(!1)}):e.jsx(Ys,{onLogin:()=>v(!0),showToast:b}),g&&e.jsx(xs,{message:g.message,type:g.type,onClose:()=>m(null)})]}):a?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsx(he,{className:"w-8 h-8 animate-spin text-gray-400"})}):e.jsxs(e.Fragment,{children:[l?e.jsx(tt,{user:l,setUser:c,showToast:b}):e.jsx(Vs,{onAuth:c,showToast:b}),g&&e.jsx(xs,{message:g.message,type:g.type,onClose:()=>m(null)})]})}ss.createRoot(document.getElementById("root")).render(e.jsx(Cs.StrictMode,{children:e.jsx(rt,{})}));
